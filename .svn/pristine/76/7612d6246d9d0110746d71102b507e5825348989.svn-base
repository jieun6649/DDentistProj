<%@ page language="java" contentType="text/html;charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>

<style>
.docBtn:hover {
	background-color: #23232B !important;
}

.searchBtn{
	background-color:#904aff; 
	border:none; 
	width:150px; 
	height:80px;
	color:white; 
	float:right;
	border-radius:50px;
	font-size:1.2rem;
	margin-top:8px;
}

.listScroll::-webkit-scrollbar{
	 display: none;
}
.dropdown-item{
	cursor: pointer;
}
.doclist{
	cursor: pointer;
}
</style>

<script type="text/javascript">
$(function(){
	
	//원외처방전 reset 버튼 table tr 초기화
	$("#reset").on("click",function(){
		$("#medi > tr").remove();
		
		if($("#mediBtn").attr("disabled")){
			$("#mediBtn").attr("disabled",false);
			$("#outsidesend").attr("disabled",true);
			$("#preview").attr("disabled",true);
			$("#drugClick").attr("disabled",false);
		}
	});
	
	//전역변수로 처리
	let drugVOList = [];
	let drugNmList = [];
	
	//원외처방전 처방 의약품 리스트에서 등록 버튼을 누르면 배열로 되는거
	$("#drugClick").on("click",function(){
		
		drugVOList = [];
		
		let tr = "";	//tr
		let td = "";		//tr안에 있는 td가 4개가 있음
		let drugNm = "";	//<input type="text"..
		let dosage = "";
		let doses = "";
		let dosesdate = "";

			//하나의 tbody안에는 현재 3개의 tr이 존재. 3회 반복
		$("#medi tr").each(function(index){
			tr = $(this);	//tr --> this는 "#medi tr"를 말하는 것, 전역변수를 선언하면 this가 #drugClick을 말하는 것이 되니까 아예 값이 안 나옴-->위에 선언만 해줘야 함
			td = tr.children();		//tr안에 있는 td가 4개가 있음
			drugNm = td.eq(0).children().val();	//<input type="text"..
			dosage = td.eq(1).children().val();
			doses = td.eq(2).children().val();
			dosesdate = td.eq(3).children().val();
			
			let jsonData = {"drugNm":drugNm,"dosage":dosage,"doses":doses,"dosesdate":dosesdate};
			
			
			drugVOList.push(jsonData);
			
		});
			
		if($(".drugNm").length<1){
			simpleErrorAlert("약품을 추가해주세요");
			return false;
		}
		
		if(dosage == "" || doses == "" || dosesdate == ""){
			simpleErrorAlert("모든 정보를 입력해주셔야 합니다");
			return false;
		}
		
		$("#drugClick").attr("disabled",true);
		
// 		console.log("----drugVOList : " + JSON.stringify(drugVOList));
// 		console.log("drugNmList : " + JSON.stringify(drugNmList));
		
		$("#outsidesend").attr("disabled",false);
		$("#mediBtn").attr("disabled",true);
		$(".dosage").attr("readonly",true);
		$(".doses").attr("readonly",true);
		$(".dosesdate").attr("readonly",true);
		
	});
	
	//원외처방전 약품 모달창에서 리스트 띄우기
	$("#mediBtn").on("click",function(){
		
		let drugNum="";
		let drugNm="";
		
		let data={
				"drugNum":drugNum,
				"drugNm":drugNm
		};
		
		$.ajax({
			url: '/hospital/document/druList',
			contentType:"application/json;charset:utf-8",
			data:JSON.stringify(data),
			type: 'post',
			dataType: 'json',
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success: function(result){
// 				console.log("result : " + JSON.stringify(result));
				
				let str="";
				//data-dismiss='modal' style='cursor:pointer;'=값 입력하면 사라지는 창
				$.each(result,function(index,DrugVO) {
					str += "<tr class='showNumNm'>";
					str+="<td class='showNum' data-dismiss='modal' style='cursor:pointer;'>"+DrugVO.drugNum+"</td><br>";
					str+="<td class='showNm' data-dismiss='modal' style='cursor:pointer;'>"+DrugVO.drugNm+"</td><br>";
					str += "</tr>";
				});
	            $("#drugList").html(str);
		},
		error:function(xhr){
			alert("xhr:"+xhr.status);
			}
		});
	});
	
	//원외처방전 약품 모달창에서 검색하면 리스트 뜸
	$(document).on("click", "#mediSearchBtn", function(event){ //모달창안의 버튼은 document 필수
		
		let keyword=$("#mediSearch").val();
		
// 		console.log(keyword);

		$.ajax({
			url: "/hospital/document/druModalSelect?keyword="+keyword,
			contentType:"application/json;charset=utf-8",
			type:"get",
			dataType:"json",
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success:function(result){
// 				console.log("result:"+JSON.stringify(result));
				
				let str="";
				
				$.each(result,function(index,DrugVO) {
					str += "<tr class='showNumNm' data-drugCd='"+ DrugVO.drugNum +"'>";
					str+="<td class='showNum' data-dismiss='modal' style='cursor:pointer;'>"+DrugVO.drugNum+"</td><br>";
					str+="<td class='showNm' data-dismiss='modal' style='cursor:pointer;'>"+DrugVO.drugNm+"</td><br>";
					str += "</tr>";
				});
				
	            $("#drugList").html(str);
			}
		});
	});
	
	//원외처방전에서 클릭하면 append로 뜨게 하기
	$(document).on("click", ".showNumNm", function(){
		
// 		console.log( "tr count ====================> ", $("#medi > tr").length ) //id가 medi(tbody)의 자식 태그인 tr의 개수
		if($("#medi > tr").length>7){
			simpleErrorAlert("더 이상 추가할 수 없습니다");
			return false;
		}
		
		//this : class="showCdNm"이 여러개이고, 이 중에서 하나를 클릭한 바로 그 요소
		let drugNum = $('.showNum', this).text().trim();
		let drugNm = $('.showNm', this).text().trim();
		
// 		console.log("showNumNm에 왔다.") 
		
		//중복된 약품 구하기
		let tr = $(this); //모달창에서 내가 click한 tr태그(약품명)
		let td = tr.children();	//내가 click한 tr태그의 자식인 td
		let ipt = td.eq(1).text(); //td의 자식에서 첫번째 (0번째는 약품 코드) 약품이름을 뽑는다
				
// 		console.log("내가 클릭한 약물 ipt : " + ipt);
		
		let drugNmList = [];
		$("#medi").children().each(function(i, tr){
// 			console.log($(tr).children().eq(0).children().val()); //table tr태그의 자식인 td의 0번째 배열의 자식인 input태그의 value값을 뽑는다
			
			const mediName = $(tr).children().eq(0).children().val(); //뽑은 값을 변수로 선언
			drugNmList.push(mediName);
		});
		
		if(drugNmList.includes(ipt)){ //drugNmList의 안에 있는 ipt랑 같다면,
			simpleErrorAlert("중복된 약품은 추가가 불가합니다");
			return false;
		}
		
		
// 		console.log("drugNum : " + drugNum+" drugNm:"+drugNm);
		
		let data = {"drugNum":drugNum, "drugNm":drugNm};
		
		$.ajax({
			url:"/hospital/document/showDrug",
			contentType:"application/json;charset:utf-8",
			data:JSON.stringify(data),
			type:"post",
			dataType:"json",
			beforeSend : function(xhr) {   // 데이터 전송 전  헤더에 csrf값 설정
		        xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success:function(result,DrugVO){
				$("#medi").append("<tr><td style='width:300px;'><input type='text' value='" + result.drugNm + "' class='drugNm' name='drugNm' style='border:none;width: 300px;text-align:center;' readonly></td>"
						+"<td><input type='number' style='width:100px;border:none;' class='dosage'></td>"
						+"<td><input type='number' style='width:100px;border:none;' class='doses'></td>"
						+"<td><input type='number' style='width:100px;border:none;' class='dosesdate'></td></tr>"	
						);
				
// 				console.log("------------- result : " + JSON.stringify(result.drugNm));
			}
		});
	});
	
	//클릭했을때 색이 바뀜
	$(".docBtn").on("click",function(){
		$(".docBtn").css("background-color","#404b57");
		$(".docBtn").css("color","white");
		$(this).css("background-color","white");
		$(this).css("color"," #404b57");
	});
	
	//원외처방전 모달창 버튼 누르면 병명 리스트 뜨기
	$("#disButton4").on("click",function(){
		let disCd="";
		let disKorNm="";
		
		let data={
				"disCd":disCd,
				"disKorNm":disKorNm
		}
		
		$.ajax({
			url: '/hospital/document/disList',
			contentType:"application/json;charset:utf-8",
			data:JSON.stringify(data),
			type: 'post',
			dataType: 'json',
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success: function(result){
// 				console.log("result : " + JSON.stringify(result));
				
				let str="";
				//data-dismiss='modal' style='cursor:pointer;'=값 입력하면 사라지는 창
				$.each(result,function(index,disVO) {
					str += "<tr class='showCdNm4'>";
					str+="<td class='showCd4' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disCd+"</td><br>";
					str+="<td class='showNm4' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disKorNm+"</td><br>";
					str += "</tr>";
				});
	            $("#disList4").html(str);
		},
		error:function(xhr){
			alert("xhr:"+xhr.status);
			}
		});
	});
	
	//원외처방전 모달창에서 검색하면 리스트 뜸
	$(document).on("click", "#disListButton4", function(event){ //모달창안의 버튼은 document 필수
		
		let keyword=$("#diskeyword4").val();
		
// 		console.log(keyword);
		
		$.ajax({
			url: "/hospital/document/disModalSelect?keyword="+keyword,
			contentType:"application/json;charset=utf-8",
			type:"get",
			dataType:"json",
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success:function(result){
// 				console.log("result:"+JSON.stringify(result));
				
				let str="";
				
				$.each(result,function(index,disVO) {
					str += "<tr class='showCdNm4'>";
					str+="<td class='showCd4' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disCd+"</td><br>";
					str+="<td class='showNm4' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disKorNm+"</td><br>";
					str += "</tr>";
				});
				
	            $("#disList4").html(str);
			}
		});
	});
	
	//원외처방전 모달창에서 질병명을 입력하고 버튼을 누르면 진단서 폼에 출력됨
	$(document).on("click", ".showCdNm4", function(){
		//this : class="showCdNm"이 여러개이고, 이 중에서 하나를 클릭한 바로 그 요소
		let disCd = $('.showCd4', this).text().trim();
		let disKorNm = $('.showNm4', this).text().trim();
		
// 		console.log("disCd : " + disCd+" disKorNm:"+disKorNm);
		
		let data = {"disCd":disCd, "disKorNm":disKorNm};
		
		$.ajax({
			url:"/hospital/document/showCdNm",
			contentType:"application/json;charset:utf-8",
			data:JSON.stringify(data),
			type:"post",
			dataType:"json",
			beforeSend : function(xhr) {   // 데이터 전송 전  헤더에 csrf값 설정
		        xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success:function(result){
// 				console.log("result : " + JSON.stringify(result.disKorNm));
				$("#disease6").val(result.disKorNm);
			}
			
		});
		
	});
	
	
	
	//치료확인서 모달창 버튼 누르면 병명 리스트 뜨기
	$("#disButton3").on("click",function(){
		
		let disCd="";
		let disKorNm="";
		
		let data={
				"disCd":disCd,
				"disKorNm":disKorNm
		}
		
		$.ajax({
			url: '/hospital/document/disList',
			contentType:"application/json;charset:utf-8",
			data:JSON.stringify(data),
			type: 'post',
			dataType: 'json',
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success: function(result){
// 				console.log("result : " + JSON.stringify(result));
				
				let str="";
				//data-dismiss='modal' style='cursor:pointer;'=값 입력하면 사라지는 창
				$.each(result,function(index,disVO) {
					str += "<tr class='showCdNm2'>";
					str+="<td class='showCd2' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disCd+"</td><br>";
					str+="<td class='showNm2' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disKorNm+"</td><br>";
					str += "</tr>";
				});
	            $("#disList3").html(str);
				
		},
		error:function(xhr){
			alert("xhr:"+xhr.status);
			}
		});
	});
	
	//치료확인서 모달창에서 검색하면 리스트 뜸
	$(document).on("click", "#disListButton3", function(event){ //모달창안의 버튼은 document 필수
		
		let keyword=$("#diskeyword3").val();
		
// 		console.log(keyword);
		
		$.ajax({
			url: "/hospital/document/disModalSelect?keyword="+keyword,
			contentType:"application/json;charset=utf-8",
			type:"get",
			dataType:"json",
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success:function(result){
// 				console.log("result:"+JSON.stringify(result));
				
				let str="";
				
				$.each(result,function(index,disVO) {
					str += "<tr class='showCdNm2'>";
					str+="<td class='showCd2' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disCd+"</td><br>";
					str+="<td class='showNm2' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disKorNm+"</td><br>";
					str += "</tr>";
				});
				
	            $("#disList3").html(str);
			}
		});
	});
	
	//치료확인서 모달창에서 질병명을 입력하고 버튼을 누르면 진단서 폼에 출력됨
	$(document).on("click", ".showCdNm2", function(){
		//this : class="showCdNm"이 여러개이고, 이 중에서 하나를 클릭한 바로 그 요소
		let disCd = $('.showCd2', this).text().trim();
		let disKorNm = $('.showNm2', this).text().trim();
		
// 		console.log("disCd : " + disCd+" disKorNm:"+disKorNm);
		
		let data = {"disCd":disCd, "disKorNm":disKorNm};
		
		$.ajax({
			url:"/hospital/document/showCdNm",
			contentType:"application/json;charset:utf-8",
			data:JSON.stringify(data),
			type:"post",
			dataType:"json",
			beforeSend : function(xhr) {   // 데이터 전송 전  헤더에 csrf값 설정
		        xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success:function(result){
// 				console.log("result : " + JSON.stringify(result.disKorNm));
				$("#disease3").val(result.disKorNm);
			}
			
		});
		
	});
	
	//향후 치료비 추정서 모달창 버튼 누르면 병명 리스트 뜨기
	$("#disButton2").on("click",function(){
		
		let disCd="";
		let disKorNm="";
		
		let data={
				"disCd":disCd,
				"disKorNm":disKorNm
		}
		
		$.ajax({
			url: '/hospital/document/disList',
			contentType:"application/json;charset:utf-8",
			data:JSON.stringify(data),
			type: 'post',
			dataType: 'json',
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success: function(result){
// 				console.log("result : " + JSON.stringify(result));
				
				let str="";
				//data-dismiss='modal' style='cursor:pointer;'=값 입력하면 사라지는 창
				$.each(result,function(index,disVO) {
					str += "<tr class='showCdNm3'>";
					str+="<td class='showCd3' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disCd+"</td><br>";
					str+="<td class='showNm3' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disKorNm+"</td><br>";
					str += "</tr>";
				});
	            $("#disList2").html(str);
				
		},
		error:function(xhr){
			alert("xhr:"+xhr.status);
			}
		});
	});
	
	
	
	//향후 치료비 추정서에서 검색창에 질병명이나 코드 치면 질병명 나옴
	$(document).on("click", "#disListButton2", function(event){ //모달창안의 버튼은 document 필수
		
		let keyword=$("#diskeyword2").val();
		
// 		console.log(keyword);

		$.ajax({
			url: "/hospital/document/disModalSelect?keyword="+keyword,
			contentType:"application/json;charset=utf-8",
			type:"get",
			dataType:"json",
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success:function(result){
// 				console.log("result:"+JSON.stringify(result));
				
				let str="";
				
				$.each(result,function(index,disVO) {
					str += "<tr class='showCdNm3'>";
					str+="<td class='showCd3' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disCd+"</td><br>";
					str+="<td class='showNm3' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disKorNm+"</td><br>";
					str += "</tr>";
				});
				
	            $("#disList2").html(str);
			}
		});
	});
	
	//향후 치료비 추정서 모달창에서 질병명을 입력하고 버튼을 누르면 진단서 폼에 출력됨
	$(document).on("click", ".showCdNm3", function(){
		//this : class="showCdNm"이 여러개이고, 이 중에서 하나를 클릭한 바로 그 요소
		let disCd = $('.showCd3', this).text().trim();
		let disKorNm = $('.showNm3', this).text().trim();
		
// 		console.log("disCd : " + disCd+" disKorNm:"+disKorNm);
		
		let data = {"disCd":disCd, "disKorNm":disKorNm};
		
		$.ajax({
			url:"/hospital/document/showCdNm",
			contentType:"application/json;charset:utf-8",
			data:JSON.stringify(data),
			type:"post",
			dataType:"json",
			beforeSend : function(xhr) {   // 데이터 전송 전  헤더에 csrf값 설정
		        xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success:function(result){
// 				console.log("result : " + JSON.stringify(result.disKorNm));
				$("#DiagnosisNum2").val(result.disKorNm);
			}
		});
		
	});
	
	//진단서 모달창 버튼 누르면 병명 리스트 뜨기
	$("#disButton").on("click",function(){
		
		let disCd="";
		let disKorNm="";
		
		let data={
				"disCd":disCd,
				"disKorNm":disKorNm
		}
		
		$.ajax({
			url: '/hospital/document/disList',
			contentType:"application/json;charset:utf-8",
			data:JSON.stringify(data),
			type: 'post',
			dataType: 'json',
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success: function(result){
// 				console.log("result : " + JSON.stringify(result));
				
				let str="";
				//data-dismiss='modal' style='cursor:pointer;'=값 입력하면 사라지는 창
				$.each(result,function(index,disVO) {
					str += "<tr class='showCdNm'>";
					str+="<td class='showCd' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disCd+"</td><br>";
					str+="<td class='showNm' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disKorNm+"</td><br>";
					str += "</tr>";
				});
	            $("#disList").html(str);
				
		},
		error:function(xhr){
			alert("xhr:"+xhr.status);
			}
		});
	});
	
	//진단서에서 검색창에 질병명이나 코드 치면 질병명 나옴
	$(document).on("click", "#disListButton", function(event){ //모달창안의 버튼은 document 필수
		
		let keyword=$("#diskeyword").val();
		
// 		console.log(keyword);

		$.ajax({
			url: "/hospital/document/disModalSelect?keyword="+keyword,
			contentType:"application/json;charset=utf-8",
			type:"get",
			dataType:"json",
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success:function(result){
// 				console.log("result:"+JSON.stringify(result));
				
				let str="";
				
				$.each(result,function(index,disVO) {
					str += "<tr class='showCdNm'>";
					str+="<td class='showCd' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disCd+"</td><br>";
					str+="<td class='showNm' data-dismiss='modal' style='cursor:pointer;'>"+disVO.disKorNm+"</td><br>";
					str += "</tr>";
				});
				
	            $("#disList").html(str);
			}
		});
	});
	
	//진단서 모달창에서 질병명을 입력하고 버튼을 누르면 진단서 폼에 출력됨
	$(document).on("click", ".showCdNm", function(){
		//this : class="showCdNm"이 여러개이고, 이 중에서 하나를 클릭한 바로 그 요소
		let disCd = $('.showCd', this).text().trim();
		let disKorNm = $('.showNm', this).text().trim();
		
// 		console.log("disCd : " + disCd+" disKorNm:"+disKorNm);
		
		let data = {"disCd":disCd, "disKorNm":disKorNm};
		
		$.ajax({
			url:"/hospital/document/showCdNm",
			contentType:"application/json;charset:utf-8",
			data:JSON.stringify(data),
			type:"post",
			dataType:"json",
			beforeSend : function(xhr) {   // 데이터 전송 전  헤더에 csrf값 설정
		        xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success:function(result){
// 				console.log("result : " + JSON.stringify(result.disKorNm));
				$("#disease").val(result.disKorNm);
			}
			
		});
		
	});
	
	$("#detailSearch").on("click",function(){
		//진단서별로 체크박스값 및 달력 값 가져오기
		$("#CTform").hide();
		$("#patientInfo").hide();
		$("#confirmform").hide();
		$("#diagform").hide();
		$("#treatform").hide();
		$("#opinionform").hide();
		$("#outsideform").hide();
		$("#docSearchform").show();
		$("#Searchlist").show();
// 		$('#docSearchlist').html('');
		
		let ptSearch=$("#ptSearch").val();
		
		if(ptSearch==null || ptSearch==""){
			simpleErrorAlert("먼저 환자를 검색해주세요");
			return false;
		}
		
		let docStartDt=$("#docStartDt").val();
		let docFinalDt=$("#docFinalDt").val();
		let ptNum=$("#chartNum7").val();
		let docNumList = [];
		$("input:checkbox[name='docNum']:checked").each(function(index,data){
			docNumList.push(data.value);
		});
		
		//파라미터 용도 : json데이터
		let data={
				"ptNum":ptNum,
				"docNumList":docNumList,
				"docStartDt" : docStartDt,
				"docFinalDt" : docFinalDt
				};
		
		
		//data : {"ptNum":"230228003","docNum":["1","3"]}
// 		console.log("data : " + JSON.stringify(data));
	
		$.ajax({
			url: '/hospital/document/checkbox',
			contentType:"application/json;charset:utf-8",
			data:JSON.stringify(data),
			type: 'post',
			dataType: 'json',
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success: function(result){
// 				console.log("result : " + JSON.stringify(result));
				
				let str="";
				
				$.each(result,function(index,docVO) {
					if(docVO.chkNum==null){
						docVO.chkNum="";
					}
					
					let docSavePath = docVO.docSavePath;
					docSavePath = docSavePath.substring(docSavePath.indexOf('\\resources'));
					docSavePath = docSavePath.replace(/\\/g, '/');
					
					str += "<tr class='doclist' data-path='" + docSavePath + "'>";
					str+="<td>"+docVO.docIssueNum+"</td><br>";
					str+="<td>"+docVO.ptNum+"</td><br>";
					str+="<td>"+docVO.docNum+"</td><br>";
					str+="<td>"+docVO.docIssueReason+"</td><br>";
					str+="<td>"+dateFormat(new Date(docVO.docIssueDt))+"</td><br>";
					str+="<td>"+docVO.chkNum+"</td><br>";
					str += "</tr>";
				});
	            $("#docSearchlist").html(str);
				
	            //날짜별 조건 검색
// 	            getDate();
		},
		error:function(xhr){
			alert("xhr:"+xhr.status);
			}
		});
	});
	
	
	//진단서
	$("#diagformsend").on("click",function(){
		
		let ptSearch=$("#ptSearch").val();
		
		if(ptSearch==null || ptSearch==""){
			simpleErrorAlert("환자를 검색해주세요");
			return false;
		}
		
		let ptNm=$("#name7").val();
		let ptRrno=$("#citizenNum7").val();
		let ptAddr=$("#addr7").val();
		let disease=$("#disease").val();
		let occur=$("#occur").val();
		let diagnosisDate=$("#diagnosisDate").val();
		let therapycon=$("#therapycon").val();
		let docIssueReason=$("#purpose").val();
		let licenseNum=$("#licenseNum").val();
		let doctorName=$("#doctorName").val();
		let ptNum=$("#chartNum7").val();
		let hiBrno=$("#num8").val();
		let hiNm=$("#name8").val();
		let hiAddr=$("#addr8").val();
		let hiPhone=$("#tel8").val();
		let hiEml=$("#email8").val();
		let chkNum= $("#ptChkSelect").val();
		
		if(disease==null || disease=="" || occur==null || occur=="" || diagnosisDate==null || diagnosisDate=="" || therapycon==null || therapycon=="" || purpose==null || purpose=="" || licenseNum==null || licenseNum=="" || doctorName==null) {
			simpleErrorAlert("양식을 모두 작성해주셔야 합니다.");
			return false;
		}
		
		$("#disPreview").attr("disabled",false);

		let data={"ptNm":ptNm, "ptRrno":ptRrno,
				"ptAddr":ptAddr,"disease":disease,
				"occur":occur,"diagnosisDate":diagnosisDate,
				"therapycon":therapycon,"docIssueReason":docIssueReason,
				"licenseNum":licenseNum,"doctorName":doctorName,
				"ptNum":ptNum, "hiBrno":hiBrno, "hiNm":hiNm,
				"hiAddr":hiAddr, "hiPhone":hiPhone, "hiEml":hiEml , "chkNum":chkNum
		};
		
// 		console.log(data);
		
		$.ajax({
			url: "/hospital/document/diagnosis",
			contentType: "application/json; charset=utf-8",
			type: "POST",
			dataType:"text",
			data: JSON.stringify(data),
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
				},	success: function(res){	
					simpleSuccessAlert("발급 완료");
					const url = '/resources/document/pdfjs/web/viewer.html?file=/resources/document/Completion/' + res;
					$("#disPreview").attr('data-path',url);
			},
			error:function(xhr){
				alert("xhr:"+xhr.status);
			}
		});
	});
	
	//향후 치료비 추정서
	$("#treatformmsend").on("click",function(){
		
		let ptSearch=$("#ptSearch").val();
		
		if(ptSearch==null || ptSearch==""){
			simpleErrorAlert("환자를 검색해주세요");
			return false;
		}
		
		let ptNm=$("#name7").val();
		let ptRrno=$("#citizenNum7").val();
		let ptAddr=$("#addr7").val();
		let DiagnosisNum=$("#DiagnosisNum2").val();
		let therapycon=$("#therapycon2").val();
		let therapyDate=$("#therapyDate2").val();
		let publishDate=$("#publishDate2").val();
		let licenseNum=$("#licenseNum2").val();
		let doctorName=$("#doctorName2").val();
		let docIssueReason=$("#purpose2").val();
		let ptNum=$("#chartNum7").val();
		let hiBrno=$("#num8").val();
		let hiNm=$("#name8").val();
		let hiAddr=$("#addr8").val();
		let hiPhone=$("#tel8").val();
		let hiEml=$("#email8").val();
		let chkNum= $("#ptChkSelect").val();
		
		if(ptNm==null || ptNm=="" || ptRrno==null || ptRrno=="" || ptAddr==null || ptAddr=="" || DiagnosisNum==null || DiagnosisNum=="" || therapycon==null || therapycon=="" ||
				therapyDate==null || therapyDate=="" || doctorName==null) {
			simpleErrorAlert("양식을 모두 작성해주셔야 합니다.");
			return false;
		}
		
		$("#treatPreview").attr("disabled",false);
		
		let data={"ptAddr":ptAddr, "ptNm":ptNm,
				"ptRrno":ptRrno,"DiagnosisNum":DiagnosisNum,
				"therapycon":therapycon,"therapyDate":therapyDate,
				"publishDate":publishDate, "licenseNum":licenseNum,
				"doctorName":doctorName, "docIssueReason":docIssueReason,
				"ptNum":ptNum,
				"hiBrno":hiBrno, "hiNm":hiNm, "hiAddr":hiAddr, "hiPhone":hiPhone, "hiEml":hiEml,
				"chkNum":chkNum
		};
		
// 		console.log(data);
		
		$.ajax({
			url: "/hospital/document/treatmentPlan",
			contentType: "application/json;charset=utf-8",
			type: "POST",
			dataType:"text",
			data: JSON.stringify(data),
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},	success: function(res){					
					simpleSuccessAlert("발급 완료");
					const url = '/resources/document/pdfjs/web/viewer.html?file=/resources/document/Completion/' + res;
					$("#treatPreview").attr('data-path',url);
			},
			error:function(xhr){
				alert("xhr:"+xhr.status);
			}
		});
	});
	
	//치료확인서
	$("#confirmformsend").on("click",function(){
		
		let ptSearch=$("#ptSearch").val();
		
		if(ptSearch==null || ptSearch==""){
			simpleErrorAlert("환자를 검색해주세요");
			return false;
		}
		
		let ptNm=$("#name7").val();
		let ptRrno=$("#citizenNum7").val();
		let ptAddr=$("#addr7").val();
		let ptGen=$("#ptGen").val();
		let disease=$("#disease3").val();
		let therapycon=$("#therapycon3").val();
		let therapyDate=$("#therapyDate3").val();
		let publishDate=$("#publishDate3").val();
		let licenseNum=$("#licenseNum3").val();
		let doctorName=$("#doctorName3").val();
		let docIssueReason=$("#purpose3").val();
		let ptNum=$("#chartNum7").val();
		let ptPhone=$("#tel7").val();
		let hiBrno=$("#num8").val();
		let hiNm=$("#name8").val();
		let hiAddr=$("#addr8").val();
		let hiPhone=$("#tel8").val();
		let hiEml=$("#email8").val();
		let chkNum= $("#ptChkSelect").val();
		
		if(ptNm==null || ptNm=="" || ptRrno==null || ptRrno=="" || ptAddr==null || ptAddr=="" || therapycon==null || therapycon=="" || disease==null || disease=="" ||
				publishDate==null) {
			simpleErrorAlert("양식을 모두 작성해주셔야 합니다.");
			return false;
		}
		
		$("#confirmPreview").attr("disabled",false);
		
		let data={"ptNm":ptNm, "ptGen":ptGen, "ptAddr":ptAddr,
				"ptRrno":ptRrno,"ptPhone":ptPhone,
				"disease":disease,"therapycon":therapycon,
				"therapyDate":therapyDate,"publishDate":publishDate,
				"licenseNum":licenseNum,
				"doctorName":doctorName,"docIssueReason":docIssueReason,"ptNum":ptNum,
				"hiBrno":hiBrno, "hiNm":hiNm, "hiAddr":hiAddr, "hiPhone":hiPhone, "hiEml":hiEml,
				"chkNum":chkNum
		};
		
// 		console.log(data);
		
		$.ajax({
			url: "/hospital/document/treatconfirm",
			contentType: "application/json;charset=utf-8",
			type: "POST",
			dataType:"text",
			data: JSON.stringify(data),
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			}, success: function(res){					
				simpleSuccessAlert("발급 완료");
				
				const url = '/resources/document/pdfjs/web/viewer.html?file=/resources/document/Completion/' + res;
				$("#confirmPreview").attr('data-path',url);
			},
			error:function(xhr){
				alert("xhr:"+xhr.status);
			}
		});
	});
	
	//CT판독
	$("#CTsend").on("click",function(){
		
		let ptSearch=$("#ptSearch").val();
		
		if(ptSearch==null || ptSearch==""){
			simpleErrorAlert("환자를 검색해주세요");
			return false;
		}
		
		let ptNm=$("#name7").val();
		let ptRrno=$("#citizenNum7").val();
		let ptAddr=$("#addr7").val();
		let ptGen=$("#ptGen").val();
		let Exdate=$("#Exdate4").val();
		let doctorname=$("#doctorname4").val();
		let licenseNum=$("#licenseNum4").val();
		let Readingfind=$("#Readingfind4").val();
		let conclusion=$("#conclusion4").val();
		let readingdate=$("#readingdate4").val();
		let docIssueReason=$("#purpose4").val();
		let ptNum=$("#chartNum7").val();
		let hiBrno=$("#num8").val();
		let hiNm=$("#name8").val();
		let hiAddr=$("#addr8").val();
		let hiPhone=$("#tel8").val();
		let hiEml=$("#email8").val();
		let chkNum= $("#ptChkSelect").val();
		
		if(ptNm==null || ptNm=="" || ptRrno==null || ptRrno=="" || ptAddr==null || ptAddr=="" || Readingfind==null || Readingfind=="" ||
				conclusion==null || conclusion=="" || doctorName==null) {
			simpleErrorAlert("양식을 모두 작성해주셔야 합니다.");
			return false;
		}
		
		$("#CTPreview").attr("disabled",false);
		
		let data={"ptNm":ptNm, "ptGen":ptGen, "Exdate":Exdate,
				"doctorname":doctorname, "ptRrno":ptRrno,"ptAddr":ptAddr,
				"licenseNum":licenseNum,"Readingfind":Readingfind,
				"conclusion":conclusion,"readingdate":readingdate,
				"docIssueReason":docIssueReason,"ptNum":ptNum,
				"hiBrno":hiBrno, "hiNm":hiNm, "hiAddr":hiAddr, "hiPhone":hiPhone, "hiEml":hiEml,
				"chkNum":chkNum
		};
		
// 		console.log(data);
		
		$.ajax({
			url: "/hospital/document/CT",
			contentType: "application/json;charset=utf-8",
			type: "POST",
			dataType:"text",
			data: JSON.stringify(data),
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
				},
			success: function(res){					
				simpleSuccessAlert("발급 완료");
				const url = '/resources/document/pdfjs/web/viewer.html?file=/resources/document/Completion/' + res;
				$("#CTPreview").attr('data-path',url);
			},
			error:function(xhr){
				alert("xhr:"+xhr.status);
			}
		});
	});
	
	//소견서
	$("#opinionsend").on("click",function(){
		
		let ptSearch=$("#ptSearch").val();
		
		if(ptSearch==null || ptSearch==""){
			simpleErrorAlert("환자를 검색해주세요");
			return false;
		}
		
		let ptNm=$("#name7").val();
		let ptRrno=$("#citizenNum7").val();
		let ptAddr=$("#addr7").val();
		let ptGen=$("#ptGen").val();
		let Clinicopinion=$("#Clinicopinion5").val();
		let docIssueReason=$("#purpose5").val();
		let publishDate=$("#publishDate5").val();
		let licenseNum=$("#licenseNum5").val();
		let doctorName=$("#doctorName5").val();
		let ptNum=$("#chartNum7").val();
		let hiBrno=$("#num8").val();
		let hiNm=$("#name8").val();
		let hiAddr=$("#addr8").val();
		let hiPhone=$("#tel8").val();
		let hiEml=$("#email8").val();
		let chkNum= $("#ptChkSelect").val();
		
		if(Clinicopinion==null || Clinicopinion=="" || docIssueReason==null || docIssueReason=="" ||
				publishDate==null || publishDate=="") {
			simpleErrorAlert("양식을 모두 작성해주셔야 합니다.");
			return false;
		} 
		
		$("#opinionPreview").attr("disabled",false);
		
		let data={"ptNm":ptNm, "ptGen":ptGen, "ptRrno":ptRrno,
				"ptAddr":ptAddr,"Clinicopinion":Clinicopinion,
				"docIssueReason":docIssueReason,"publishDate":publishDate,
				"licenseNum":licenseNum,"doctorName":doctorName,"ptNum":ptNum,
				"hiBrno":hiBrno, "hiNm":hiNm, "hiAddr":hiAddr, "hiPhone":hiPhone, "hiEml":hiEml
				,"chkNum":chkNum
		};
		
// 		console.log(data);
		
		$.ajax({
			url: "/hospital/document/opinion",
			contentType: "application/json;charset=utf-8",
			type: "POST",
			dataType:"text", //controller에서 반환 타입이 String이라면 dataType을 text로 바꿔줘야 함. json타입은 반환타입이 map이나 vo일 때만 가능
			data: JSON.stringify(data),
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
				},
			success: function(res){					
				simpleSuccessAlert("발급 완료");
				
				const url='/resources/document/pdfjs/web/viewer.html?file=/resources/document/Completion/' + res;
				$("#opinionPreview").attr('data-path',url);
			},
			error:function(xhr){
				alert("xhr:"+xhr.status);
			}
		});
	});
	
	//발급 버튼 클릭. 원외처방전
		$("#outsidesend").on("click",function(){
		
			
		let ptSearch = $("#ptSearch").val();
		
		if(ptSearch==null || ptSearch==""){
			simpleErrorAlert("환자를 검색해주세요");
			return false;
		}
			
		let ptNm=$("#name7").val();
		let ptRrno=$("#citizenNum7").val();
		let ptAddr=$("#addr7").val();
		let year=$("#year6").val();
		let disease=$("#disease6").val();
		let doctorName=$("#doctorName6").val();
		let licenseNum=$("#licenseNum6").val();
		let docIssueReason=$("#purpose6").val();
		let ptNum=$("#chartNum7").val();
		
		let deliver=$("#deliver6").val();
		let date=$("#date6").val();
		
		let hiBrno=$("#num8").val();
		let hiNm=$("#name8").val();
		let hiAddr=$("#addr8").val();
		let hiPhone=$("#tel8").val();
		let hiEml=$("#email8").val();
		let chkNum= $("#ptChkSelect").val();
		
		if(year==null || year=="" || ptNm==null || ptNm=="" || ptRrno==null || ptRrno=="" || ptAddr==null || ptAddr=="" || docIssueReason==null || docIssueReason==""|| doctorName==null) {
			simpleErrorAlert("양식을 모두 작성해주셔야 합니다.");
			return false;
		}
		
		$("#outSidePreview").attr("disabled",false);

		let data={"year":year, 
				"ptNm":ptNm,"ptRrno":ptRrno,"ptAddr":ptAddr,
				"disease":disease,"doctorName":doctorName,
				"licenseNum":licenseNum,
				"deliver":deliver,"date":date, "docIssueReason":docIssueReason,"ptNum":ptNum,
				"hiBrno":hiBrno, "hiNm":hiNm, "hiAddr":hiAddr, "hiPhone":hiPhone, "hiEml":hiEml
				,"chkNum":chkNum
				,"drugVOList":JSON.stringify(drugVOList)

		};
		
// 		console.log("data : " + JSON.stringify(data));
		
		$.ajax({
			url: "/hospital/document/outside",
			contentType: "application/json;charset=utf-8",
			type: "POST",
			dataType:"text",
			data: JSON.stringify(data),
			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
			},
			success: function(res){					
				simpleSuccessAlert("발급 완료");
				const url = '/resources/document/pdfjs/web/viewer.html?file=/resources/document/Completion/' + res;
				$("#outSidePreview").attr('data-path',url);
			},
			error:function(xhr){
				alert("xhr:"+xhr.status);
			}
		});
	});
	
	//진단서
	$("#diagnosis").on("click",function(){
		$("#diagform").show();
		$("#patientInfo").show();
		$("#treatform").hide();
		$("#confirmform").hide();
		$("#CTform").hide();
		$("#opinionform").hide();
		$("#outsideform").hide();
		$("#docSearchform").hide();
		$("#Searchlist").hide();
	});
	//향후 치료비 추정서
	$("#treatment").on("click",function(){
		$("#treatform").show();
		$("#patientInfo").show();
		$("#diagform").hide();
		$("#confirmform").hide();
		$("#CTform").hide();
		$("#opinionform").hide();
		$("#outsideform").hide();
		$("#docSearchform").hide();
		$("#Searchlist").hide();
	});
	//치료확인서
	$("#confirm").on("click",function(){
		$("#confirmform").show();
		$("#patientInfo").show();
		$("#diagform").hide();
		$("#treatform").hide();
		$("#CTform").hide();
		$("#opinionform").hide();
		$("#outsideform").hide();
		$("#docSearchform").hide();
		$("#Searchlist").hide();
	});
	//ct판독확인서
	$("#CT").on("click",function(){
		$("#CTform").show();
		$("#patientInfo").show();
		$("#confirmform").hide();
		$("#diagform").hide();
		$("#treatform").hide();
		$("#opinionform").hide();
		$("#outsideform").hide();
		$("#docSearchform").hide();
		$("#Searchlist").hide();
	});
	//소견서
	$("#opinion").on("click",function(){
		$("#opinionform").show();
		$("#patientInfo").show();
		$("#CTform").hide();
		$("#confirmform").hide();
		$("#diagform").hide();
		$("#treatform").hide();
		$("#outsideform").hide();
		$("#docSearchform").hide();
		$("#Searchlist").hide();
	});
	//원외처방전
	$("#outside").on("click",function(){
		$("#outsideform").show();
		$("#patientInfo").show();
		$("#Searchlist").hide();
		$("#docSearchform").hide();
		$("#opinionform").hide();
		$("#CTform").hide();
		$("#confirmform").hide();
		$("#diagform").hide();
		$("#treatform").hide();
		
	});
	//서류검색
	$("#docSearch").on("click",function(){
		$("#docSearchform").show();
		$("#Searchlist").show();
		$(".doclist").show();
		$("#outsideform").hide();
		$("#opinionform").hide();
		$("#CTform").hide();
		$("#confirmform").hide();
		$("#diagform").hide();
		$("#treatform").hide();
		$("#patientInfo").hide();
		
	});
	
});

//searchModule.js에서 onmousedown="selectPt(this)를 선언했기 때문에 아래 메소드에 target이 따로 붙지 않아서 따로 써야함
function selectPt(target){
// 	console.log("target==> ", target)
	const ptInfo = target.textContent;
	$('#ptSearch').val(ptInfo);
	const ptNum = target.dataset.ptnum;

	$.ajax({
		url: '/hospital/document/patientInfo?ptNum=' + ptNum,
		type: 'get',
		dataType: 'json',
		success: function(result){
// 			console.log("result : " + JSON.stringify(result));
			
			$("#name7").val(result.ptNm);
			$("#chartNum7").val(result.ptNum);
			$("#citizenNum7").val(result.ptRrno);
			$("#ptGen").val(result.ptGen);
			
			const ptBrdt = result.ptBrdt;
			$("#birth7").val(ptBrdt);
			
			let bornYear = ptBrdt.substring(0,4);
			let today = new Date();
			let age = today.getYear() + 1900 - parseInt(bornYear);
			
			$("#age7").val(age);
			$("#addr7").val(result.ptAddr+", "+result.ptAddrDet);
			$("#tel7").val(result.ptPhone);
			
			let chkOptions = '';
			result.chkList.forEach(function(chk){
				chkOptions += '<option value="' + chk.chkNum + '">' + chk.chkNum + '</option>';
			});

			$('#ptChkSelect').html(chkOptions);
			
			//환자 진료번호 입력하기
			getSelect();
			//병원 정보 함수 호출
			getHos();
			//환자 서류 리스트 함수 호출
			getDoclist(target);
		}
	});
	
}

function getSelect(){
	let select=$("#ptChkSelect").val();
// 	console.log("select:"+select);
}

function getHos(){//병원 정보
	$.ajax({
		url: '/hospital/document/hospitalInfo',
		type:'get',
		dataType:'json',
		success:function(result){
// 			console.log("result:"+JSON.stringify(result));
// 			console.log(result.hiBrno); 
// 			console.log(result.hiNm);
// 			console.log(result.hiPhone);
// 			console.log(result.hiAddr);
			
		$("#name8").val(result.hiNm);
		$("#addr8").val(result.hiAddr+", "+result.hiDaddr);
		$("#tel8").val(result.hiPhone);
		$("#email8").val(result.hiEml);
		$("#num8").val(result.hiBrno);
		}
	});
}

function getDoclist(target){ //환자 서류 리스트
	
	const ptNum = target.dataset.ptnum;
// 	console.log("ptNum ==> ", ptNum);
		$.ajax({
			url: "/hospital/document/doclist?ptNum=" + ptNum,
			contentType:"application/json;charset=utf-8",
			type:"get",
			dataType:"json",
			success:function(result){
// 				console.log("---result:"+JSON.stringify(result));
					
				let str="";
			
				$.each(result,function(index,docVO) {
					if(docVO.chkNum==null){
						docVO.chkNum="";
					}
					let docSavePath = docVO.docSavePath;
					docSavePath = docSavePath.substring(docSavePath.indexOf('\\resources'));
					docSavePath = docSavePath.replace(/\\/g, '/');
					
					str += "<tr class='doclist' data-path='" + docSavePath + "'>";
					str+="<td>"+docVO.docIssueNum+"</td><br>";
					str+="<td>"+docVO.ptNum+"</td><br>";
					str+="<td>"+docVO.docNum+"</td><br>";
					str+="<td>"+docVO.docIssueReason+"</td><br>";
					str+="<td>"+dateFormat(new Date(docVO.docIssueDt))+"</td><br>";
					str+="<td>"+docVO.chkNum+"</td><br>";
					str += "</tr>";
				});
	            $("#docSearchlist").html(str);
			}
		});
	}

	//위에 new Date 함수
	function dateFormat(mydate){
		   let month = (mydate.getMonth()+1);
		   month = month < 10 ? "0" + month : month;
		   let day = mydate.getDate();
		   day = day < 10 ? "0" + day : day;
		   
		   return mydate.getFullYear() + "-" + month + "-" + day;
	}
	
	//pdf 열도록 하는 함수
	function openPdfViewer(target){
		const targetUrl = $(target).data('path');
		setTimeout(open(targetUrl), 5000);
	}
	
	// 서류 검색 목록을 클릭하면 PDF뷰어로 볼 수 있다.
	$(document).on('click', '.doclist', function(){
		const path = $(this).data('path');
		open('/resources/document/pdfjs/web/viewer.html?file=' + path);
	});
	
// 	날짜 데이트 체크박스
// 	function getDate() {
		
// 		let ptNum=$("#chartNum7").val();
// 		let docStartDt=$("#docStartDt").val();
// 		let docFinalDt=$("#docFinalDt").val();
		
// 		console.log("docStartDt:"+docStartDt);	
// 		console.log("docFinalDt:"+docFinalDt);
		
// 		let data={"docStartDt":docStartDt, "docFinalDt":docFinalDt};
		
// 		console.log("data : " + JSON.stringify(data));
		
// 		$.ajax({
// 			url: '/hospital/document/getDate',
// 			contentType:"application/json;charset:utf-8",
// 			data:JSON.stringify(data),
// 			type: 'post',
// 			dataType: 'json',
// 			beforeSend : function(xhr) { // 데이터 전송 전 헤더에 csrf값 설정
// 				xhr.setRequestHeader("${_csrf.headerName}", "${_csrf.token}");
// 			},
// 			success: function(result){
// 				console.log("result : " + JSON.stringify(result));
				
// 				let str="";
				
// 				$.each(result,function(index,docVO) {
// 					str += "<tr>";
// 					str+="<td>"+docVO.docIssueNum+"</td><br>";
// 					str+="<td>"+docVO.ptNum+"</td><br>";
// 					str+="<td>"+docVO.docNum+"</td><br>";
// 					str+="<td>"+docVO.docIssueReason+"</td><br>";
// 					str+="<td>"+dateFormat(new Date(docVO.docIssueDt))+"</td><br>";
// 					str+="<td>"+docVO.chkNum+"</td><br>";
// 					str += "</tr>";
// 				});
// 	            $("#docSearchlist").html(str);
				
// 		},
// 		error:function(xhr){
// 			alert("xhr:"+xhr.status);
// 			}
// 		});
// 	}
	
// 	//날짜 체크박스 하나만 선택
// 	function clickCheck(target) {
// 	    document.querySelectorAll(`input[name=date]`)
// 	        .forEach(el => el.checked = false);
// 	    target.checked = true;
// 	}

</script>
<c:set var="empInfo" value="${pageContext.request.userPrincipal.principal.empVO}" />
<div class="content-wrapper" style="background-color: rgb(101, 125, 150); min-height: 1033px;">

<nav class="navbar navbar-expand navbar-white navbar-light" style="background-color: #404b57;">

		<div class="dropdown">
			<input type="search" class="form-control" id="ptSearch" name="ptSearch" placeholder="환자 검색" onkeyup="searchPatient(this);" style="width: 400px;">
			<ul id="ptSearchDropdown" class="dropdown-menu">
			</ul>
		</div>
		<ul class="navbar-nav ml-auto">
		</ul>
	</nav>


<section class="content" style="margin-top: 1%;">

<!-- sidebar 시작 -->
<div class="row">
<div class="col-2">
<button type="button" class="btn btn-block btn-secondary btn-lg docBtn" id="docSearch" name="docSearch" style="height: 80px; background-color:white; border:none; color:rgb(64, 75, 87);">서류 검색</button>
<button type="button" class="btn btn-block btn-secondary btn-lg docBtn" id="diagnosis" name="diagnosis" style="height: 80px; background-color:#404b57; border:none;">진단서</button>
<button type="button" class="btn btn-block btn-secondary btn-lg docBtn" id="opinion" name="opinion" style="height: 80px; background-color:#404b57; border:none;">소견서</button>
<button type="button" class="btn btn-block btn-secondary btn-lg docBtn" id="confirm" name="confirm" style="height: 80px; background-color:#404b57; border:none;">치료확인서</button>
<button type="button" class="btn btn-block btn-secondary btn-lg docBtn" id="treatment" name="treatment" style="height: 80px; background-color:#404b57; border:none;">향후 치료비 추정서</button>
<button type="button" class="btn btn-block btn-secondary btn-lg docBtn" id="CT" name="CT" style="height: 80px; background-color:#404b57; border:none;">CT판독소견서</button>
<button type="button" class="btn btn-block btn-secondary btn-lg docBtn" id="outside" name="outside" style="height: 80px; background-color:#404b57; border:none;">원외처방전</button>
</div>
<!-- sidebar 끝-->

<!-- 서류 검색 탭 시작 -->
<div class="col-sm-10" id="Searchlist">
	<div class="card">
		<div class="card-header" style="background-color:#404b57;">
			<h3 class="card-title" style="color:white;">서류 검색</h3>
		</div>
		<div class="card-body" style="font-family: 'Noto Sans KR', sans-serif; font-weight:700;">
			<div class="row">
				<div class="col-sm-4">			
			    	<label for="docStartDt" style="font-size:1.2rem;">날짜</label>
			    	<br />
			    	<input type="date" id="docStartDt">&nbsp;&nbsp;~&nbsp;&nbsp;<input type="date" id="docFinalDt">
		    	</div>
		    	<div class="col-sm-5">
					<label for="docNum1" style="font-size:1.2rem;">서류 종류</label>
					<br />
				
					<label><input type="checkbox" id="docNum1" name="docNum" value="1"> 진단서</label>
				    <label><input type="checkbox" id="docNum2" name="docNum" value="2"> 소견서</label>
				    <label><input type="checkbox" id="docNum3" name="docNum" value="3"> 치료확인서</label><br>
				    <label><input type="checkbox" id="docNum4" name="docNum" value="4"> 향후 치료비 추정서</label>
				    <label><input type="checkbox" id="docNum5" name="docNum" value="5"> CT판독소견서</label>
				    <label><input type="checkbox" id="docNum6" name="docNum" value="6"> 원외처방전</label>
				</div>
				<div class="col-sm-1"></div>
				<div class="col-sm-2">
					<button type="button" id="detailSearch" name="detailSearch" class="btn btn-primary searchBtn">상세 검색</button>
				</div>
			</div>
		</div>
	</div>

		<div id="docSearchform">
        <form action="/hospital/document/document" method="post" id="frm" name="frm">
          <div class="card">
            <div class="card-header" style="background-color:#404b57;">
              <h3 class="card-title" style="color:white;">리스트 목록</h3>
			</div>
			<div class="card-body" >
				<table class="table table-bordered">
					<colgroup>
						<col width="15%">
						<col width="15%">
						<col width="7%">
						<col width="15%">
						<col width="10%">
						<col width="15%">
					</colgroup>
					<thead style="text-align:center; font-family: 'Noto Sans KR', sans-serif; font-weight:700;">
						<tr>
							<th class="p-3">발급번호</th>
							<th class="p-3">차트번호</th>
							<th class="p-3">서류번호</th>
							<th class="p-3">발급사유</th>
							<th class="p-3">발급일시</th>
							<th class="p-3">진료번호</th>
						</tr>
					</thead>
				</table>
				<div style="overflow: scroll;overflow-x: hidden; height: 600px;" class="listScroll">
				<table class="table table-bordered">
						<col width="15%">
						<col width="15%">
						<col width="7%">
						<col width="15%">
						<col width="10%">
						<col width="15%">
					<tbody id="docSearchlist" style= "font-family: 'Noto Sans KR', sans-serif; font-weight:500; text-align:center;">
						<!-- 리스트  -->
					</tbody>
				</table>
				</div>
			</div>
			</div>
			</form>
			</div>
			</div>
		<!-- 서류 검색 탭 끝 -->
      
        <!-- 진단서 탭시작 -->
        <div class="col-sm-6" id="diagform" style="display: none;">
        <form action="/hospital/document/diagnosis" method="post" id="frm" name="frm">
          <div class="card">
            <div class="card-header" style="background-color:#404b57;">
              <h3 class="card-title" style="color:white;">진단서</h3>
            </div>
			<div class="card-body">
				<div class="form-group">
					<label>질병명</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="disease" name="disease" readonly>
						<!-- modal 버튼 -->
						<button type="button" id="disButton" class="btn btn-secondary" data-toggle="modal" data-target="#modal-default">
						검색
						</button>
						<!-- modal -->
						<div class="modal fade" id="modal-default">
						<div class="modal-dialog modal-dialog-scrollable">
						<div class="modal-content">
						<div class="modal-header">
						<h4 class="modal-title">상병코드 및 병명</h4>
						</div>
						<div class="modal-body">
						
						<div class="dropdown">
							<input type="search" class="form-control" id="diskeyword" name="diskeyword" placeholder="상병코드 및 병명 입력" style="width: 300px;float:left;margin-bottom: 20px;">
						</div>
						<button type="button" class="btn btn-md btn-default" id="disListButton" name="disListButton" ><i class="fas fa-fw fa-search"></i></button>
						
							<div class="form-group">
								<table class="table table-bordered" style="margin-bottom:0px;">
								<colgroup>
									<col width="40%">
									<col width="60%">
								</colgroup>
									<thead style="text-align:center; font-family: 'Noto Sans KR', sans-serif; font-weight:700;">
										<tr>
											<th class="p-3">코드</th>
											<th class="p-3">병명</th>
										</tr>
									</thead>
								</table>
								<div style="overflow: scroll;overflow-x: hidden; height: 600px;" class="listScroll">
									<table class="table table-bordered">
										<colgroup>
											<col width="40%">
											<col width="60%">
										</colgroup>
										<tbody id="disList" style="font-family: 'Noto Sans KR', sans-serif; font-weight:500; text-align:center;">
										<!-- 리스트  -->
										</tbody>
									</table>
								</div>
							</div>
						</div>
						<!-- modal footer -->						
						<div class="modal-footer justify-content-between">
						<button type="button" class="btn btn-default" data-dismiss="modal">닫기</button>
						</div>
						<!-- modal footer 끝 -->
						</div>
						</div>
						</div>
					</div>
				</div>
				<div class="form-group">
					<label>치료 내용</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="therapycon" name="therapycon">
					</div>
				</div>
				<div class="form-group">
					<label>발병연월일</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="date" class="form-control" id="occur" name="occur">
					</div>
				</div>
				<div class="form-group">
					<label>진단연월일</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="date" class="form-control" id="diagnosisDate" name="diagnosisDate">
					</div>
				</div>
				<div class="form-group">
					<label>용도</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="purpose" name="purpose">
					</div>
				</div>
				<div class="form-group">
					<label>의사 면허번호</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="licenseNum" name="licenseNum" value="${empInfo.doctLn}" readonly>
					</div>
				</div>
				<div class="form-group">
					<label>의사 이름</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="doctorName" name="doctorName" value="${empInfo.empNm}" readonly>
					</div>
				</div>
				<button type="button" class="btn btn-default" id="diagformsend" name="diagformsend">발급</button>
				<input type='reset' class="btn btn-default" value='초기화'/>
				<button type="button" class="btn btn-default" id="disPreview" name="disPreview" style="float: right;" onclick="openPdfViewer(this);" data-data="" disabled>미리보기</button>
			</div>
            <div class="card-body table-responsive p-0" id="tabCard">
              <div id="example2_wrapper" class="dataTables_wrapper dt-bootstrap4">
                <div class="row">
                  <div class="col-sm-12">
                  </div>
                </div>
              </div>
            </div>
          </div>
          </form>
        </div>
        <!-- 진단서 작성 끝 -->
   
    <!-- 소견서 시작 -->
	<div class="col-sm-6" id="opinionform" style="display: none;">
        <form action="/hospital/document" method="post" id="frm" name="frm">
          <div class="card">
            <div class="card-header" style="background-color:#404b57;">
              <h3 class="card-title" style="color:white;">소견서</h3>
            </div>
			<div class="card-body">
				<div class="form-group">
					<label>진료소견</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="Clinicopinion5" id="Clinicopinion5">
					</div>
				</div>
				<div class="form-group">
					<label>용도</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="purpose5" id="purpose5">
					</div>
				</div>
				<div class="form-group">
					<label>발행일</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="date" class="form-control" name="publishDate5" id="publishDate5">
					</div>
				</div>
				<div class="form-group">
					<label>면허번호</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="licenseNum5" id="licenseNum5" value="${empInfo.doctLn}" readonly>
					</div>
				</div>
				<div class="form-group">
					<label>의사 이름</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="doctorName5" id="doctorName5" value="${empInfo.empNm}" readonly>
					</div>
				</div>
				<button type="button" class="btn btn-default" id="opinionsend" name="opinionsend">발급</button>
				<input type='reset' class="btn btn-default" value='초기화' />
				<button type="button" class="btn btn-default" id="opinionPreview" name="opinionPreview" style="float: right;" onclick="openPdfViewer(this);" data-data="" disabled>미리보기</button>
			</div>
            <div class="card-body table-responsive p-0" id="tabCard">
              <div id="example2_wrapper" class="dataTables_wrapper dt-bootstrap4">
                <div class="row">
                  <div class="col-sm-12">
                  </div>
                </div>
              </div>
            </div>
          </div>
	</form>
	</div>
   	<!-- 소견서 작성 끝 -->
   
   	 <!-- 향후 치료비 추정서 시작 -->
	<div class="col-sm-6" id="treatform" style="display: none;">
        <form action="/hospital/document" method="post" id="frm" name="frm">
          <div class="card">
            <div class="card-header" style="background-color:#404b57;">
              <h3 class="card-title" style="color:white;">향후 치료비 추정서</h3>
            </div>
			<div class="card-body">
				<div class="form-group">
					<label>질병명</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="DiagnosisNum2" name="DiagnosisNum2" readonly>
						
						<!-- modal 버튼 -->
						<button type="button" id="disButton2" class="btn btn-secondary" data-toggle="modal" data-target="#modal-default2"> <!-- 여기 data-target이랑 같아야 함 -->
						검색
						</button>
						<!-- modal -->
						<div class="modal fade" id="modal-default2"> <!-- 여기 id값이랑 -->
						<div class="modal-dialog modal-dialog-scrollable">
						<div class="modal-content">
						<div class="modal-header">
						<h4 class="modal-title">상병코드 및 병명</h4>
						</div>
						<div class="modal-body">
						
						<div class="dropdown">
							<input type="search" class="form-control" id="diskeyword2" name="diskeyword2" placeholder="상병코드 및 병명 입력" style="width: 300px;float:left;margin-bottom: 20px;">
						</div>
						<button type="button" class="btn btn-md btn-default" id="disListButton2" name="disListButton2" ><i class="fas fa-fw fa-search"></i></button>
						
							<div class="form-group">
								<table class="table table-bordered" style="margin-bottom:0px;">
								<colgroup>
									<col width="40%">
									<col width="60%">
								</colgroup>
									<thead style="text-align:center; font-family: 'Noto Sans KR', sans-serif; font-weight:700;">
										<tr>
											<th class="p-3">코드</th>
											<th class="p-3">병명</th>
										</tr>
									</thead>
								</table>
								<div style="overflow: scroll;overflow-x: hidden; height: 600px;" class="listScroll">
									<table class="table table-bordered">
									<colgroup>
										<col width="40%">
										<col width="60%">
									</colgroup>
										<tbody id="disList2" style="font-family: 'Noto Sans KR', sans-serif; font-weight:500; text-align:center;">
										<!-- 리스트  -->
										</tbody>
									</table>
								</div>
							</div>
						</div>
						<!-- modal footer -->						
						<div class="modal-footer justify-content-between">
						<button type="button" class="btn btn-default" data-dismiss="modal">닫기</button>
						</div>
						</div>
						</div>
						</div>
						
					</div>
				</div>
				<div class="form-group">
					<label>치료내용</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="therapycon2" id="therapycon2">
					</div>
				</div>
				<div class="form-group">
					<label>치료기간</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="number" class="form-control"  name="therapyDate2" id="therapyDate2">
					</div>
				</div>
				<div class="form-group">
					<label>발행일</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="date" class="form-control" name="publishDate2" id="publishDate2">
					</div>
				</div>
				<div class="form-group">
					<label>용도</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="purpose2" name="purpose2">
					</div>
				</div>
				<div class="form-group">
					<label>면허번호</label>
	 				<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="licenseNum2" id="licenseNum2" value="${empInfo.doctLn}" readonly>
					</div>
				</div>
				<div class="form-group">
					<label>의사 이름</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="doctorName2" id="doctorName2" value="${empInfo.empNm}" readonly>
					</div>
				</div>
				<button type="button" class="btn btn-default" id="treatformmsend" name="treatformmsend">발급</button>
				<input type='reset' class="btn btn-default" value='초기화' />
				<button type="button" class="btn btn-default" id="treatPreview" name="treatPreview" onclick="openPdfViewer(this);" style="float: right;" data-data="" disabled>미리보기</button>
			</div>
            <div class="card-body table-responsive p-0" id="tabCard">
              <div id="example2_wrapper" class="dataTables_wrapper dt-bootstrap4">
                <div class="row">
                  <div class="col-sm-12">
                  </div>
                </div>
              </div>
            </div>
          </div>
	</form>
	</div>
   	<!-- 향후 치료비 추정서 작성 끝 -->
   	
   	 <!-- CT판독소견서 시작 -->
	<div class="col-sm-6" id="CTform" style="display: none;">
        <form action="/hospital/document" method="post" id="frm" name="frm">
          <div class="card">
            <div class="card-header" style="background-color:#404b57;">
              <h3 class="card-title" style="color:white;">CT판독소견서</h3>
            </div>
			<div class="card-body">
				<div class="form-group">
					<label>검사일자</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="date" class="form-control" name="Exdate4" id="Exdate4">
					</div>
				</div>
				<div class="form-group">
					<label>용도</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="purpose4" name="purpose4">
					</div>
				</div>
				<div class="form-group">
					<label>의사 이름</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="doctorname4" id="doctorname4" value="${empInfo.empNm}" readonly>
					</div>
				</div>
				<div class="form-group">
					<label>면허번호</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="licenseNum4" id="licenseNum4" value="${empInfo.doctLn}" readonly>
					</div>
				</div>
				<div class="form-group">
					<label>판독소견</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="Readingfind4" id="Readingfind4">
					</div>
				</div>
				<div class="form-group">
					<label>결론</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="conclusion4" id="conclusion4">
					</div>
				</div>
				<div class="form-group">
					<label>판독일자</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="date" class="form-control" name="readingdate4" id="readingdate4">
				</div>
				</div>
				<button type="button" class="btn btn-default" id="CTsend" name="CTsend">발급</button>
				<input type='reset' class="btn btn-default" value='초기화' />
				<button type="button" class="btn btn-default" id="CTPreview" name="CTPreview" onclick="openPdfViewer(this);" style="float: right;" data-data="" disabled>미리보기</button>
			</div>
            <div class="card-body table-responsive p-0" id="tabCard">
              <div id="example2_wrapper" class="dataTables_wrapper dt-bootstrap4">
                <div class="row">
                  <div class="col-sm-12">
                  </div>
                </div>
              </div>
            </div>
          </div>
	</form>
	</div>
   	<!-- CT판독소견서 작성 끝 -->
   	
   	<!-- 치료확인서 시작 -->
	<div class="col-sm-6" id="confirmform" style="display: none;">
        <form action="/hospital/document" method="post" id="frm" name="frm">
          <div class="card">
            <div class="card-header" style="background-color:#404b57;">
              <h3 class="card-title" style="color:white;">치료확인서</h3>
            </div>
			<div class="card-body">
				<div class="form-group">
					<label>질병명</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="disease3" name="disease3" readonly>
						
						<!-- modal 버튼 -->
						<button type="button" id="disButton3" class="btn btn-secondary" data-toggle="modal" data-target="#modal-default3"> <!-- 여기 data-target이랑 같아야 함 -->
						검색
						</button>
						<!-- modal -->
						<div class="modal fade" id="modal-default3"> <!-- 여기 id값이랑 -->
						<div class="modal-dialog modal-dialog-scrollable">
						<div class="modal-content">
						<div class="modal-header">
						<h4 class="modal-title">상병코드 및 병명</h4>
						</div>
						<div class="modal-body">
						
						<div class="dropdown">
							<input type="search" class="form-control" id="diskeyword3" name="diskeyword3" placeholder="상병코드 및 병명 입력" style="width: 300px;float:left;margin-bottom: 20px;">
						</div>
						<button type="button" class="btn btn-md btn-default" id="disListButton3" name="disListButton3" ><i class="fas fa-fw fa-search"></i></button>
						
							<div class="form-group">
								<table class="table table-bordered" style="margin-bottom:0px;">
								<colgroup>
									<col width="40%">
									<col width="60%">
								</colgroup>
									<thead style="text-align:center; font-family: 'Noto Sans KR', sans-serif; font-weight:700;">
										<tr>
											<th class="p-3">코드</th>
											<th class="p-3">병명</th>
										</tr>
									</thead>
								</table>
								<div style="overflow: scroll;overflow-x: hidden; height: 600px;" class="listScroll">
									<table class="table table-bordered">
									<colgroup>
										<col width="40%">
										<col width="60%">
									</colgroup>
									<tbody id="disList3" style="font-family: 'Noto Sans KR', sans-serif; font-weight:500; text-align:center;">
									<!-- 리스트  -->
								</tbody>
								</table>
								</div>
							</div>
						</div>
						<!-- modal footer -->						
						<div class="modal-footer justify-content-between">
						<button type="button" class="btn btn-default" data-dismiss="modal">닫기</button>
						</div>
						</div>
						</div>
						</div>
						<!-- modal footer 끝 -->
						
					</div>
				</div>
				<div class="form-group">
					<label>치료내용</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="therapycon3" name="therapycon3">
					</div>
				</div>
				<div class="form-group">
					<label>치료기간</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="number" class="form-control" id="therapyDate3" name="therapyDate3">
					</div>
				</div>
				<div class="form-group">
					<label>발행일</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="date" class="form-control" name="publishDate3" id="publishDate3">
					</div>
				</div>
				<div class="form-group">
					<label>용도</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="purpose3" name="purpose3">
					</div>
				</div>
				<div class="form-group">
					<label>면허번호</label>
	 				<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="licenseNum3" id="licenseNum3" value="${empInfo.doctLn}" readonly>
					</div>
				</div>
				<div class="form-group">
					<label>의사 이름</label>
	 				<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="doctorName3" id="doctorName3" value="${empInfo.empNm}" readonly>
					</div>
				</div>
				<button type="button" class="btn btn-default" id="confirmformsend" name="confirmformsend">발급</button>
				<input type='reset' class="btn btn-default" value='초기화' />
				<button type="button" class="btn btn-default" id="confirmPreview" name="confirmPreview" onclick="openPdfViewer(this);" style="float: right;" data-data="" disabled>미리보기</button>
			</div>
            <div class="card-body table-responsive p-0" id="tabCard">
              <div id="example2_wrapper" class="dataTables_wrapper dt-bootstrap4">
                <div class="row">
                  <div class="col-sm-12">
                  </div>
                </div>
              </div>
            </div>
          </div>
	</form>
	</div>
   	<!-- 치료확인서 작성 끝 -->
   	
   	<!-- 원외처방전 시작 -->
	<div class="col-sm-6" id="outsideform" style="display: none;">
        <form action="/hospital/document" method="post" id="frm" name="frm">
          <div class="card">
            <div class="card-header" style="background-color:#404b57;">
              <h3 class="card-title" style="color:white;">원외처방전</h3>
            </div>
			<div class="card-body">
				<div class="form-group">
					<label>교부연월일</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
							<input type="date" class="form-control" name="year6" id="year6"/>
					</div>
				</div>
				<div class="form-group">
					<label>질병명</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="disease6" id="disease6" readonly/>
						
						<!-- modal 버튼 -->
						<button type="button" id="disButton4" class="btn btn-secondary" data-toggle="modal" data-target="#modal-default4"> <!-- 여기 data-target이랑 같아야 함 -->
						검색
						</button>
						<!-- modal -->
						<div class="modal fade" id="modal-default4"> <!-- 여기 id값이랑 -->
						<div class="modal-dialog modal-dialog-scrollable">
						<div class="modal-content">
						<div class="modal-header">
						<h4 class="modal-title">상병코드 및 병명</h4>
						</div>
						<div class="modal-body">
						
						<div class="dropdown">
							<input type="search" class="form-control" id="diskeyword4" name="diskeyword4" placeholder="상병코드 및 병명 입력" style="width: 300px;float:left;margin-bottom: 20px;">
						</div>
						<button type="button" class="btn btn-md btn-default" id="disListButton4" name="disListButton4" ><i class="fas fa-fw fa-search"></i></button>
						
							<div class="form-group">
								<table class="table table-bordered" style="margin-bottom:0px;">
								<colgroup>
									<col width="40%">
									<col width="60%">
								</colgroup>
									<thead style="text-align:center; font-family: 'Noto Sans KR', sans-serif; font-weight:700;">
										<tr>
											<th class="p-3">코드</th>
											<th class="p-3">병명</th>
										</tr>
									</thead>
								</table>
								<div style="overflow: scroll;overflow-x: hidden; height: 600px;" class="listScroll">
									<table class="table table-bordered">
										<colgroup>
											<col width="40%">
											<col width="60%">
										</colgroup>
										<tbody id="disList4" style="font-family: 'Noto Sans KR', sans-serif; font-weight:500; text-align:center;">
										<!-- 리스트  -->
										</tbody>
								</table>
								</div>
							</div>
						</div>
						<!-- modal footer -->						
						<div class="modal-footer justify-content-between">
						<button type="button" class="btn btn-default" data-dismiss="modal">닫기</button>
						</div>
						</div>
						</div>
						</div>
						<!-- modal footer 끝 -->
						
					</div>
				</div>
				<div class="form-group">
					<label>용도</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="purpose6" name="purpose6" />
					</div>
				</div>
				<div class="form-group">
					<label>면허번호</label>
 					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="licenseNum6" id="licenseNum6" value="${empInfo.doctLn}" readonly/>
					</div>
				</div>
				<div class="form-group">
					<label>의사 이름</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" name="doctorName6" id="doctorName6" value="${empInfo.empNm}" readonly/>
					</div>
				</div>
						<!-- modal -->
						<div class="modal fade" id="modal-default5">
						<div class="modal-dialog modal-lg modal-dialog-scrollable">
						<div class="modal-content">
						<div class="modal-header">
						<h4 class="modal-title">약품코드 및 약품명</h4>
						</div>
						<div class="modal-body">
						<p style="color: red;">약품 선택 후 등록버튼을 누르셔야 합니다</p>
						
						<div class="dropdown">
							<input type="search" class="form-control" id="mediSearch" name="mediSearch" placeholder="처방 의약품 검색" style="width: 300px;float:left;margin-bottom: 20px;">
						</div>
						<button type="button" class="btn btn-md btn-default" id="mediSearchBtn" name="mediSearchBtn" ><i class="fas fa-fw fa-search"></i></button>
						
							<div class="form-group">
								<table class="table table-bordered" style="margin-bottom:0px;">
									<colgroup>
										<col width="40%">
										<col width="60%">
									</colgroup>
										<thead style="text-align:center; font-family: 'Noto Sans KR', sans-serif; font-weight:700;">
											<tr>
												<th class="p-3">코드</th>
												<th class="p-3">약품명</th>
											</tr>
										</thead>
								</table>
								<div style="overflow: scroll;overflow-x: hidden; height: 600px;" class="listScroll">
								<table class="table table-bordered">
									<colgroup>
										<col width="40%">
										<col width="60%">
									</colgroup>
									<tbody id="drugList" style="font-family: 'Noto Sans KR', sans-serif; font-weight:500; text-align:center; table-layout: fixed;">
									<!-- 리스트  -->
									</tbody>
								</table>
								</div>
							</div>
						</div>
						<!-- modal footer -->						
						<div class="modal-footer justify-content-between">
						<button type="button" class="btn btn-default" data-dismiss="modal">닫기</button>
						</div>
						</div>
						</div>
						</div>
						<!-- modal footer 끝 -->
				
				<table class="table table-bordered" style="overflow-x:scroll;">
					<thead style="text-align:center; font-family:'Noto Sans KR', sans-serif; font-weight:700;">
						<tr>
							<th class="p-3" style="width:40%;">처방의약품</th>
							<th class="p-3" style="width:20%;">1회 투여량</th>
							<th class="p-3" style="width:20%;">1회 투여횟수</th>
							<th class="p-3" style="width:20%;">1회 투약일수</th>
						</tr>
					</thead>
					<tbody style="font-family: 'Noto Sans KR', sans-serif; font-weight:500; text-align:center;" id="medi">
					</tbody>
				</table>
				
				<br/>
				<button type="button" class="btn btn-md btn-default" id="drugClick" name="drugClick" >등록</button>
				<!-- modal 버튼 -->
				<button type="button" id="mediBtn" class="btn btn-default" data-toggle="modal" data-target="#modal-default5"> <!-- 여기 data-target이랑 같아야 함 -->검색</button>
				<p style="color: red;">등록버튼을 누를 시 약품 선택 및 수정이 불가합니다</p>

				<div class="form-group">
					<label style="float: left;margin-left: 200px;">교부일부터</label>
					<label style="float: right; margin-right: 200px;">일간</label>
	 				<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="number" class="form-control" name="deliver6" id="deliver6"/>
						<input type="number" class="form-control" name="date6" id="date6" />
					</div>
				</div>
				<button type="button" class="btn btn-default" id="outsidesend" name="outsidesend" disabled>발급</button>
				<input type='reset' class="btn btn-default" value='초기화' id="reset" />
				<button type="button" class="btn btn-default" id="outSidePreview" name="outSidePreview" onclick="openPdfViewer(this);" style="float: right;" data-data="" disabled>미리보기</button>
			</div>
            <div class="card-body table-responsive p-0" id="tabCard">
              <div id="example2_wrapper" class="dataTables_wrapper dt-bootstrap4">
              </div>
            </div>
          </div>
	</form>
	</div>
   	<!-- 원외처방전 작성 끝 -->
   	
        <!-- 환자 정보 시작 -->
        <div class="col-sm-4" id="patientInfo" style="display: none;">
          <div class="card">
            <div class="card-header" style="background-color:#404b57;">
             <h3 class="card-title" style="color:white;">환자 정보</h3>	
            </div>
            <div class="card-body">
          		<div class="form-group">
					<label>환자 이름</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="name7" name="name7" readonly>
					</div>
				</div>
				<div class="form-group">
					<label>성별</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="ptGen" name="ptGen" readonly>
					</div>
				</div>
          		<div class="form-group">
					<label>차트번호</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="chartNum7" name="chartNum7" readonly>
					</div>
				</div>
          		<div class="form-group">
					<label>주민등록번호</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="citizenNum7" name="citizenNum7" readonly>
					</div>
				</div>
          		<div class="form-group">
					<label>생년월일</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="birth7" name="birth7" readonly>
					</div>
				</div>
          		<div class="form-group">
					<label>나이</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="number" class="form-control" id="age7" name="age7" readonly>
					</div>
				</div>
          		<div class="form-group">
					<label>주소</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="addr7" name="addr7" readonly>
					</div>
				</div>
          		<div class="form-group">
					<label>전화번호</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<input type="text" class="form-control" id="tel7" name="tel7" readonly>
					</div>
				</div>
          		<div class="form-group">
					<label>진료 번호</label>
					<div class="input-group">
						<div class="input-group-prepend"></div>
						<select id="ptChkSelect" name="ptChkSelect" class="form-control" onchange="getSelect()">
						</select>
					</div>
				</div>
				</div>
				</div>
				<!-- 환자 정보 끝 -->
				<!-- 병원 정보 시작 -->
				<div class="card">
            		<div class="card-header" style="background-color:#404b57;">
            		<h3 class="card-title" style="color:white;">병.의원 정보</h3>	
           		 	</div>
          			<div class="card-body">
          			<div class="form-group">
						<label>사업자 등록번호</label>
							<div class="input-group">
								<div class="input-group-prepend"></div>
								<input type="text" class="form-control" id="num8" name="num8" readonly>
							</div>
					</div>
					<div class="form-group">
						<label>병.의원명</label>
							<div class="input-group">
								<div class="input-group-prepend"></div>
								<input type="text" class="form-control" id="name8" name="name8" readonly>
							</div>
					</div>
					<div class="form-group">
						<label>주소</label>
						<div class="input-group">
							<div class="input-group-prepend"></div>
							<input type="text" class="form-control" id="addr8" name="addr8" readonly>
						</div>
					</div>
					<div class="form-group">
						<label>전화번호</label>
						<div class="input-group">
							<div class="input-group-prepend"></div>
							<input type="text" class="form-control" id="tel8" name="tel8" readonly>
						</div>
					</div>
					<div class="form-group">
						<label>이메일</label>
						<div class="input-group">
							<div class="input-group-prepend"></div>
							<input type="text" class="form-control" id="email8" name="email8" readonly>
						</div>
					</div>
					</div>
	            </div>
         </div>
        </div>
        <!-- 병원 정보 끝 -->
        
</section>
</div>

<script src="/resources/js/searchModule.js"></script>
<script src="/resources/js/alertModule.js"></script>
