<%@ page language="java" contentType="text/html;charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags" %>
<style>
.row .hospitalRow {
	margin: 20px;
}

.row .zip {
	margin-top: 10px;
	margin-left: 20px;
	margin-right: 20px;
}

body, input[type="button"] {
	font-family: bookman old style;
	font-size: 12pt;
}

table {
	border-collapse: collapse;
	margin: auto;
}

th, td {
	padding: 6px;
}

input[type="button"] {
	border: 2px solid indianred;
	background: antiquewhite;
	cursor: pointer;
	margin-top: 20px;
}

input[type="button"]:hover {
	background: indianred;
	color: antiquewhite;
}

.card-footer{
	background-color: white;
}

</style>

<!--  ë‹¤ìŒ ì£¼ì†Œapi -->
<script src="https://ssl.daumcdn.net/dmaps/map_js_init/postcode.v2.js"></script>
<!-- ë©”ì‹œì§€ì°½ -->
<script src="/resources/js/alertModule.js"></script>
<!-- ê¶Œí•œ -->
<sec:authorize access="hasRole('ROLE_ADMIN')">
	<script>
		$(function(){
			$("#addTr").prop("disabled", false);  //ì¶”ê°€ë²„íŠ¼ í™œì„±í™”
			$("#updateChair").prop("disabled", false); //ì €ì¥ë²„íŠ¼ í™œì„±í™”
			$("#deleteChair").prop("disabled", false); //ì‚­ì œë²„íŠ¼ í™œì„±í™”
			$("#updateBtn").show(); //ë³‘ì›ì •ë³´ ìˆ˜ì •ë²„íŠ¼ í™œì„±í™”
			
			$("#updateBtn").on("click", function(){
				$("#hiType").attr("disabled", false);
				$("#uploadFile").attr("disabled", false);
				$("#zipSearch").attr("disabled", false);
				
				$("#hiBrno").prop("readonly", false);
				$("#hiNm").prop("readonly", false);
				$("#hiPhone").prop("readonly", false);
				$("#hiFax").prop("readonly", false);
				$("#hiZip").prop("readonly", false);
				$("#hiAddr").prop("readonly", false);
				$("#hiDaddr").prop("readonly", false);
				$("#hiEml").prop("readonly", false);
				$("#hiHp").prop("readonly", false);
				$("#hiRprsvNm").prop("readonly", false);
				$("#hiRprsvRrno").prop("readonly", false);
				$("#hiOpenTime").prop("readonly", false);
				$("#hiCloseTime").prop("readonly", false);
				$("#hiLunchStime").prop("readonly", false);
				$("#hiLunchEtime").prop("readonly", false);
			});
		});
	</script>
</sec:authorize>

<script type="text/javascript">
// ë‹¤ìŒ ì£¼ì†Œì°¾ê¸° API
function openHomeSearch() {
    new daum.Postcode({
        // ì„ íƒ ì™„ë£Œ ì‹œ ë°ì´í„°ë¥¼ í¼ì— ë‹´ì•„ì¤€ë‹¤.
        oncomplete : function(data) {
            document.frm.hiZip.value = data.zonecode; // ìš°í¸ë²ˆí˜¸
            document.frm.hiAddr.value = data.address; // ì£¼ì†Œ
            document.frm.hiDaddr.value = data.buildingName; // ê±´ë¬¼ì£¼ì†Œ
        }
    }).open();
}

// ì²´ì–´ê´€ë¦¬- ì²´ì–´ ì¶”ê°€ë²„íŠ¼ í´ë¦­í–ˆì„ ë•Œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
function addRow() {

	  // í…œí”Œë¦¿ ê°€ì ¸ì˜¤ê¸°
	  const template = document.querySelector('#rowTemplate');
	  
	  // ì¶”ê°€í•  í…Œì´ë¸” ê°€ì ¸ì˜¤ê¸°
	  //const tbl = document.querySelector('#myTable');
	  
	  // ì™¼ìª½ ìˆ«ì í‘œì‹œ ì„¤ì •
	  const td_slNo = template.content.querySelectorAll("td")[1];
	  const tr_count = $("#myTable tbody tr").length;
	  td_slNo.textContent = tr_count;
	  
	  // í…œí”Œë¦¿ì˜ content ì†ì„±ê³¼ ê·¸ì˜ ìì‹ ëª¨ë“  ìš”ì†Œë¥¼ ë³µì‚¬
	  const clone = template.content.cloneNode(true); 
	  
	  // ê¸°ì¡´ í…Œì´ë¸”ì— ë³µì‚¬í•œ í…œí”Œë¦¿ì„ ì¶”ê°€
	  //tbl.appendChild(clone);
	  
	  $("#myTable tbody").append(clone);
	  
	  // ìˆ˜ì •ë²„íŠ¼ í´ë¦­ -> ì €ì¥ëª¨ë“œ ì „í™˜
	  // 	//spn1 : ê°€ë ¤ì§ / spn2 : ë³´ì„
	 $("#spn1").hide();
	 $("#spn2").show();
	 
}


// ì²´ì–´ê´€ë¦¬- ì²´ì–´ ì¶”ê°€ í›„ ì €ì¥ë²„íŠ¼ ëˆŒë €ì„ ë•Œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
function createRow(){
	  
	  // ì²´í¬ëœ ì²´í¬ë°•ìŠ¤ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.
	  var checkbox = $("input[name=user_Check]:checked");
	  console.log(checkbox);
	  
	  
	  var checkYn = $("#checkYn");
	  if(!checkYn.is(":checked")){
		  simpleErrorAlert("ì¶”ê°€í•  ì²´ì–´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.") 
		  return false;
	  } 
		
// 	  let tr = checkbox.parent().parent();
// 	  let td = tr.children();
	  
	  // ë°°ì—´ ìƒì„±
	  var arr = [];
	  
	  let emptyFlag = false;
	  
	  checkbox.each(function(i){
		var a = {};
		
		var tr = checkbox.parent().parent().eq(i); // tr
		console.log("tr: " , tr);
		var td = tr.children(); // trì˜ ìì‹ìš”ì†Œë“¤
	
		// td.eq(0)ì€ ì²´í¬ë°•ìŠ¤ ì´ë¯€ë¡œ td.eq(1)ì˜ ê°’ë¶€í„° ê°€ì ¸ì˜¨ë‹¤.
		a.chairSn = td.eq(1).text();
		a.chairNm = td.eq(2).children().val();
		a.deptCd = td.eq(3).find("#deptCd").val();
		
		if(a.chairNm == '' || a.deptCd == ''){
			emptyFlag = true;
		}
			
		console.log("a : " + JSON.stringify(a));
			
// 			// ì²´í¬ëœ rowì˜ ëª¨ë“  ê°’ì„ ë°°ì—´ì— ë‹´ëŠ”ë‹¤.
// 			arr.push(chairSn); 
// 			arr.push(chairNm); 
// 			arr.push(deptCd);
 
		arr.push(a);

	  });
			
	  if(emptyFlag) {
		  simpleErrorAlert("ì²´ì–´ ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”");
		  return false;
	  }
		
	  console.log("arr : ", arr);
			
			$.ajax({
				url : '/hospital/manage/hosInfo/createChair',
				type : 'post',
				data : JSON.stringify(arr),
				contentType: 'application/json;charset=utf-8',
				beforeSend: function(xhr){
					xhr.setRequestHeader('X-CSRF-TOKEN', '${_csrf.token}');
				}, 
				success : function(result){
					
					$("#myTable tbody").empty();
					
					console.log("result : " + JSON.stringify(result));
					
// 					var resultList =  JSON.stringify(result);
					
					let str = "";
					$(result).each(function(index, chairVO){
					// {"chairSn":39,"chairNm":"4ë²ˆ ì²´ì–´","deptCd":"1"}
					  const template = document.querySelector('#readOnlyTemplate');					  
					  
					  // í…œí”Œë¦¿ì˜ content ì†ì„±ê³¼ ê·¸ì˜ ìì‹ ëª¨ë“  ìš”ì†Œë¥¼ ë³µì‚¬
					  const clone = template.content.cloneNode(true); 
					  
					  // ì²´í¬ë°•ìŠ¤ html íƒœê·¸ ì„¤ì •
					  const tr = clone.querySelector("tr");
					  tr.setAttribute("class", "trClassDelete");
					  
					  const td_checkBox = clone.querySelectorAll("td")[0].querySelector("#checkYn");
					  td_checkBox.setAttribute("class", "chairSelected");
					  td_checkBox.setAttribute("id", "deleteChairCheck");
					  td_checkBox.setAttribute("name", "user_CheckBox");
					  
					  // ì™¼ìª½ ìˆ«ì í‘œì‹œ ì„¤ì •
					  const td_slNo = clone.querySelectorAll("td")[1];
					  td_slNo.textContent = chairVO.chairSn;
					  
					  // ì˜ì ì´ë¦„ ì„¤ì •
					  const td_chName = clone.querySelectorAll("td")[2].querySelector("#chairNm");
					  td_chName.value = chairVO.chairNm;
					  td_chName.setAttribute("class", "updateInput")
					  td_chName.setAttribute("readonly", true)
					  
					  // ë¶€ì„œ ì´ë¦„ ì„¤ì •
					  const td_deptCd = clone.querySelectorAll("td")[3].querySelector("#deptCd");
					  td_deptCd.value = chairVO.deptCd;
						  
				 	  $("#myTable tbody").append(clone);	  	
				 	  
				 	 simpleSuccessAlert('ì²´ì–´ ì •ë³´ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
					});
					 $("#spn1").show();
					 $("#spn2").hide();
				}
			});  
}

// ì²´ì–´ ì‚­ì œ
function deleteRow(){
	
	  // ì²´í¬ëœ ì²´í¬ë°•ìŠ¤ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.
	  var checkbox = $("input[name=user_CheckBox]:checked");
	  console.log("checkbox : " ,checkbox);
	  
	  var chairSelected = $(".chairSelected");
	  console.log("chairSelected : " + chairSelected)
	  if(!chairSelected.is(":checked")){
		  simpleErrorAlert("ì‚­ì œí•  í•­ëª©ì— ì²´í¬í•˜ì—¬ì£¼ì‹­ì‹œì˜¤.") 
		  return false;
	  } 
	  
	  let tr = checkbox.parent().parent();
	  let td = tr.children();
	  
	  // ë°°ì—´ ìƒì„±
	  var arr = [];                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
	  
	  checkbox.each(function(i){
		  var a = {};
			
			var tr = checkbox.parent().parent().eq(i); // tr
			console.log("tr: " , tr);
			var td = tr.children(); // trì˜ ìì‹ìš”ì†Œë“¤
		
			// td.eq(0)ì€ ì²´í¬ë°•ìŠ¤ ì´ë¯€ë¡œ td.eq(1)ì˜ ê°’ë¶€í„° ê°€ì ¸ì˜¨ë‹¤.
			a.chairSn = td.eq(1).text();
			a.chairNm = td.eq(2).children().val();
			a.deptCd = td.eq(3).find("#deptCd").val();
			
			console.log("a : " + JSON.stringify(a));
			
//			// ì²´í¬ëœ rowì˜ ëª¨ë“  ê°’ì„ ë°°ì—´ì— ë‹´ëŠ”ë‹¤.
//			arr.push(chairSn); 
//			arr.push(chairNm); 
//			arr.push(deptCd);

			arr.push(a);
		});
		
		
			console.log("arr : ", arr);
			
			$.ajax({
				url : '/hospital/manage/hosInfo/deleteChair',
				type : 'post',
				data : JSON.stringify(arr),
				contentType: 'application/json;charset=utf-8',
				beforeSend: function(xhr){
					xhr.setRequestHeader('X-CSRF-TOKEN', '${_csrf.token}');
				}, 
				success : function(res){
					
					$(".trClassDelete").each(function(i, tr){
						if($(tr).find('.chairSelected').prop('checked')){
							$(tr).remove();
						}
					});
					
					simpleSuccessAlert('ì²´ì–´ ì •ë³´ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
				}
			});  
}


// ì²´ì–´ê´€ë¦¬- ì²´ì–´ ìˆ˜ì •
function updateRow(){
	
// 	var total_cnt=0;
// 	var tdArr = new Array();
	var checkbox = $("input[name=user_CheckBox]:checked");
	var arr = [];
	
	//ì²´í¬ëœ ì²´í¬ë°•ìŠ¤ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.
	checkbox.each(function(i){
		
		var a = {};
		
		var tr = checkbox.parent().parent().eq(i); // tr
		var td = tr.children(); // trì˜ ìì‹ìš”ì†Œë“¤
		
		//ì²´í¬ëœ rowì˜ ëª¨ë“  ê°’ì„ ë°°ì—´ì— ë‹´ëŠ”ë‹¤.
	
		//td.eq(0)ì€ ì²´í¬ë°•ìŠ¤ ì´ë¯€ë¡œ td.eq(1)ì˜ ê°’ë¶€í„° ê°€ì ¸ì˜¨ë‹¤.
		a.chairSn = td.eq(1).text();
		a.chairNm = td.eq(2).find(".updateInput").val();
		a.deptCd = td.eq(3).find("#deptCd").val();
		
		console.log(a);
		arr.push(a); //ê°ì²´ë¥¼ ë°°ì—´ì•ˆì— ë„£ëŠ”ë‹¤.
		
	});
	
	
		console.log("arr : ", arr);
		
		$.ajax({
			url : '/hospital/manage/hosInfo/updateChair',
			type : 'post',
			data : JSON.stringify(arr),
			contentType: 'application/json;charset=utf-8',
			beforeSend: function(xhr){
				xhr.setRequestHeader('X-CSRF-TOKEN', '${_csrf.token}');
			}, 
			success : function(res){
				console.log("res : " + res);
				
				simpleSuccessAlert('ì²´ì–´ ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
				checkbox.click();
			}
		});
}
	
		
$(document).ready(function(){
	
	$("#saveBtn").hide();
	
	// ì²´ì–´ê´€ë¦¬- ì·¨ì†Œë²„íŠ¼ í´ë¦­ì‹œ ì¼ë°˜ëª¨ë“œë¡œ ì „í™˜	
	$("#cancelBtn").on("click",function(){
		$("#spn1").show();	
		$("#spn2").hide();
			
		$(".trClassAdd").remove();
	});	// ì·¨ì†Œë²„íŠ¼ í´ë¦­ì´ë²¤íŠ¸ ë..
	
	$(document).on("change", ".chairSelected", function(){
		
		// ì²´í¬ë°•ìŠ¤ í™œì„±í™”í–ˆì„ ì‹œ
		if($(this).is(":checked")){
			//alert("ì²´í¬");
			
			//parents(í•´ë‹¹ ìš”ì†Œì˜ ìœ„ì—ìˆëŠ” ë¶€ëª¨ë“¤ ì¤‘ <tr>ìš”ì†Œë¥¼ ì°¾ê³  ì°¾ì€ <tr>ìš”ì†Œì˜ ìì‹ ì¤‘ .updateInput í´ë˜ìŠ¤ì´ë¦„ì„ ê°€ì§„ ìš”ì†Œì˜ styleì„ ë³€ê²½ )
			//parent(í•´ë‹¹ ìš”ì†Œì˜ ë°”ë¡œ ìœ„ì—ìˆëŠ” ë¶€ëª¨ë¥¼ ì°¾ì•„ <tr>ìš”ì†Œë¥¼ ì°¾ê³  ì°¾ì€ <tr>ìš”ì†Œì˜ ìì‹ ì¤‘ .updateInput í´ë˜ìŠ¤ì´ë¦„ì„ ê°€ì§„ ìš”ì†Œì˜ styleì„ ë³€ê²½ )
			//children(í•´ë‹¹ ìš”ì†Œì˜ ì•„ë˜ì— ìˆëŠ” ìì‹ë“¤ ì¤‘ <tr>ìš”ì†Œë¥¼ ì°¾ê³  ì°¾ì€ <tr>ìš”ì†Œì˜ ìì‹ ì¤‘ .updateInput í´ë˜ìŠ¤ì´ë¦„ì„ ê°€ì§„ ìš”ì†Œì˜ styleì„ ë³€ê²½)
			//child(í•´ë‹¹ ìš”ì†Œì˜ ë°”ë¡œ ì•„ë˜ì— ìˆëŠ” ìì‹ì„ ì°¾ì•„ <tr>ìš”ì†Œë¥¼ ì°¾ê³  ì°¾ì€ <tr>ìš”ì†Œì˜ ìì‹ ì¤‘ .updateInput í´ë˜ìŠ¤ì´ë¦„ì„ ê°€ì§„ ìš”ì†Œì˜ styleì„ ë³€ê²½)
		
// 			$(this).parent().find(".updateInput").attr("readonly", false); //ì²´ì–´ëª…
			$(this).parent().next().next().find(".updateInput").prop("readonly", false); //ì²´ì–´ëª…
			$(this).parent().next().next().find(".updateInput").css("border", "1px solid blue"); //ì²´ì–´ëª… ì‘ì„±ë€ í…Œë‘ë¦¬
			$(this).parent().parent().find("#deptCd").prop("disabled", false); //ë¶€ì„œ ì„ íƒë€ ì‘ì„±ê°€ëŠ¥ ì²˜ë¦¬
			
			
// 			const newText = document.createElement('input');
// 			newText.innerHTML = "<input type='text'>";
// 			$(".update1").appendCild(newText);
		}else{
			//alert("ì²´í¬í•´ì œ");
// 			$("#chairSn").prop("disabled", true);
// 			$(".updateInput").attr("readonly", true); 
			$(this).parent().next().next().find(".updateInput").prop("readonly", true);
			$(this).parent().next().next().find(".updateInput").css("border", "none");
			$(this).parent().parent().find("#deptCd").prop("disabled", true);
		}
	})
	
	
	$("#updateBtn").on("click", function(){
			//alert("ì²´í¬ ëˆŒë ¸ë‹¤!");
			
			// nameê°’ì„ ì‚¬ìš©í•´ì„œ ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
			let hiBrno = $("#hiBrno").val();
			console.log("hiBrno : " + hiBrno);
			
			// readonly true -> readonly false
			$(".form-control-user").attr("readonly", false);	
			$("#uploadFile").attr("disabled", false);
			$("#updateBtn").hide();
			$("#saveBtn").show();
// 			$("#backData").show(); //ë³´ë¥˜
		})
		
// 	$("#backData").on("click", function(){
			
		
// 	});	
	
	
	$("#saveBtn").on("click", function(){
// 		alert("ì €ì¥");
		
		$("#updateBtn").show();
		$("#saveBtn").hide();
		
		//í¼ë°ì´í„° ê°€ì ¸ì˜¤ê¸°(íŒŒì¼ê¹Œì§€ í¬í•¨í•˜ì—¬ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŒ.)
		let frm = document.querySelector("#frm");
		let formData = new FormData(frm);
		console.log("formData"+ formData);
		
		let hiRprsvNm = document.querySelector("#hiRprsvNm").value;
		let hiRprsvRrno = document.querySelector("#hiRprsvRrno").value;
		
		var juminRule=/^(?:[0-9]{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[1,2][0-9]|3[0,1]))-[1-8][0-9]{6}$/;
		
		if(!juminRule.test(hiRprsvRrno)) {
			simpleErrorAlert("[ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸]\n í˜•ì‹ì— ë§ê²Œ ì…ë ¥í•˜ì„¸ìš”!\n ex)000000-0000000")
			$("#updateBtn").hide();
			$("#saveBtn").show();
			return false;
		}
		
		let hiOpenTime = document.querySelector("#hiOpenTime").value;
		let hiCloseTime = document.querySelector("#hiCloseTime").value;
		let hiLunchStime = document.querySelector("#hiLunchStime").value;
		let hiLunchEtime = document.querySelector("#hiLunchEtime").value;
		
		formData.append("hiRprsvNm", hiRprsvNm)
		formData.append("hiRprsvRrno", hiRprsvRrno)
		formData.append("hiOpenTime", hiOpenTime)
		formData.append("hiCloseTime", hiCloseTime)
		formData.append("hiLunchStime", hiLunchStime)
		formData.append("hiLunchEtime", hiLunchEtime)
		
		$.ajax({
			url : '/hospital/manage/hosInfo/updatePost',
			type : 'post',
			contentType : false,
			processData : false,
			beforeSend: function(xhr){
				xhr.setRequestHeader('X-CSRF-TOKEN', '${_csrf.token}');
			},
			data : formData,
			success : function(result){
				console.log("result : " + JSON.stringify(result));
				
				$("#hiImg").attr("src", "/resources/images/hospital" + result.hiImg);
				
			},
			dataType : 'json'
		});
			// readonly false -> readonly true
			$(".form-control-user").attr("readonly", true);	
			$("#hiType").attr("disabled", true);
			$("#uploadFile").attr("disabled", true);
			simpleSuccessAlert("ë³‘ì› ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
	});
	
	//ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ì‹œì‘/////////////////////////////////
	$("#uploadFile").on("change", handleImgFileSelect);
	
	function handleImgFileSelect(event){  //changeëœ eventê°€ ë”°ë¼ì˜¨ë‹¤.
		let files = event.target.files; //íŒŒì¼ì´ 1ê°œë“  ì—¬ëŸ¬ê°œë“  íŒŒì¼ì„ ê°€ì ¸ì˜¨ë‹¤.
		let fileArr = Array.prototype.slice.call(files); //ë°°ì—´í˜•íƒœë¡œ ì €ì¥í•œë‹¤.
		fileArr.forEach(function(f){
			if(!f.type.match("image.*")){
				simpleErrorAlert("ì´ë¯¸ì§€ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
				return;
			}
			
			let reader = new FileReader();
			reader.onload = function(event){
				//ì½ì€ ê²°ê³¼
				//<img src = "SFHEHFDG.jpg>"
				let img_html = "<img src=\"" + event.target.result + "\" style='width:140px;' />";
				
				$(".bg-register-image").html(img_html);
			}
			reader.readAsDataURL(f);
		});
	}
	//ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ë/////////////////////////////////
	
	function fn_retrieveList(){
		
		$.ajax({
			url : '/hospital/manage/hosInfo/createChair',
			type : 'post',
			contentType : false,
			processData : false,
			beforeSend: function(xhr){
				xhr.setRequestHeader('X-CSRF-TOKEN', '${_csrf.token}');
			},
			data : formData,
			success : function(result){
				
				 $("#myTable tbody").empty();
				
				console.log("result : " + result);
				
				var resultList = result.resultList;
				
				$(resultList).each(function(index, object){
					
				  const template = document.querySelector('#readOnlyTemplate');					  
				  
				  // ì™¼ìª½ ìˆ«ì í‘œì‹œ ì„¤ì •
				  const td_slNo = template.content.querySelectorAll("td")[1];
				  const tr_count = $("#myTable tbody tr").length;
				  td_slNo.textContent = tr_count;
				  
					  
				  // í…œí”Œë¦¿ì˜ content ì†ì„±ê³¼ ê·¸ì˜ ìì‹ ëª¨ë“  ìš”ì†Œë¥¼ ë³µì‚¬
				  const clone = template.content.cloneNode(true); 
					  
					  
			 	  $("#myTable tbody").append(clone);	  
				  $("#myTable tbody tr:last").find("#deptCd").val("3");					  
					
				});
				
				
				
				// readonly false -> readonly true
			
			},
			dataType : 'json'
		});	
	}
});

</script>

<div class="content-wrapper"
	 style="background-color: rgb(101, 125, 150); min-height: 1001px;">
	<!-- main ê²€ìƒ‰ì°½ì„ í¬í•¨í•œ navbar ì‹œì‘-->
	<nav class="navbar navbar-expand navbar-white navbar-light"
		 style="background-color: #404b57;">

		<div class="dropdown">
			<!-------------------- ê²€ìƒ‰ëŒ€ -------------------->
			<input type="text" class="form-control" id="keyword" name="keyword"
				placeholder="" style="width: 400px;" disabled>
			<ul id="ptSearchDropdown" class="dropdown-menu">	
			</ul>
			<!-------------------- ê²€ìƒ‰ëŒ€ -------------------->
		</div>
<!-- 		<img src="/resources/images/layout/hospital/memo_icon.png" alt="ë©”ëª¨" id="memo" class="brand-image elevation-1" style="margin-left: 15px;"> -->
		<ul class="navbar-nav ml-auto"></ul>
		<div class="manageMenu">
			<ul class="navbar-nav me-auto mb-2 mb-lg-0">
				<li class="nav-item"><a class="nav-link"
					href="/hospital/manage/empInfo"
					style="color: white;">ì§ì›ê´€ë¦¬</a></li>
				<li class="nav-item"><a class="nav-link" href="/hospital/drug"
					style="color: white;">ì•½í’ˆê´€ë¦¬</a></li>
				<li class="nav-item"><a class="nav-link"
					href="/hospital/txCode" style="color: white;">ì²˜ì¹˜ ê´€ë¦¬</a></li>
				<li class="nav-item"><a class="nav-link"
					href="/hospital/manage/hosInfo" style="color: white;">ë³‘ì› ê¸°ì´ˆì •ë³´ê´€ë¦¬</a></li>
			</ul>
		</div>
		<!-- 
		<div class="collapse navbar-collapse" id="navbarTogglerDemo03"
			style="margin-left: 47%;">
			<ul class="navbar-nav me-auto mb-2 mb-lg-0">
				<li class="nav-item">
					<a class="nav-link"	href="/hospital/manage/empInfo" style="color: white;">ì§ì›ê´€ë¦¬</a></li>
				<li class="nav-item"><a class="nav-link" href="/hospital/drug"
					style="color: white;">ì•½í’ˆê´€ë¦¬</a></li>
				<li class="nav-item"><a class="nav-link"
					href="/hospital/txCode" style="color: white;">ì²˜ì¹˜ ê´€ë¦¬</a></li>
				<li class="nav-item"><a class="nav-link"
					href="/hospital/manage/hosInfo" style="color: white;">ë³‘ì› ê¸°ì´ˆì •ë³´ê´€ë¦¬</a></li>
			</ul>
		</div>
		 -->
	</nav>
	<!-- main ê²€ìƒ‰ì°½ì„ í¬í•¨í•œ navbar ë -->

<!-- 	<div class="SaveRow"> -->
<!-- 		<input type="button" id="saveBtn" class="btn btn-danger btnCss btn-block" -->
<!-- 			   style="float: right; margin-right: 15px; background-color: #ff3e3e; height: 100%; width: 7%; margin-top: .9rem; margin-bottom: .9rem;" value="ë³‘ì›ì •ë³´ ì €ì¥" /> -->
<!-- 		<input type="button" class="btn btn-success btn-inline btnCss" id="backData"  value="ëŒì•„ê°€ê¸°" -->
<!-- 			   style="background-color: #904aff; border: none; width: 10%;" /> -->
<!-- 		<input type="button" id="updateBtn" class="btn btn-danger btnCss btn-block" -->
<!-- 			   style="float: right; margin-right: 15px; display:none; background-color: #ff3e3e; height: 100%; width: 7%; margin-top: .9rem; margin-bottom: .9rem;" value="ë³‘ì›ì •ë³´ ìˆ˜ì •"/> -->
<!-- 	</div> -->
	<section class="content" style="margin-top: 1%;">
		<div class="row">
			
			<!-- ì¢Œì¸¡ ìƒë‹¨ -->
			<div class="col-md-6">
				<form id="frm" name="frm" action="/hospital/manage/hosInfo/updatePost?${_csrf.parameterName}=${_csrf.token}" method="post" enctype="multipart/form-data">
				<div class="card card-info">
					<div class="card-header"
						 style="background-color: #404b57; border: none;">
						<div class="d-flex justify-content-between align-items-center">
							<h2 class="card-title">ë³‘ì›ê¸°ì´ˆì •ë³´</h2>
							<!-- ë³‘ì› ì •ë³´ ìˆ˜ì • ë²„íŠ¼ -->
							<input type="button" id="updateBtn" class="btn btn-danger btnCss m-0 border-0"
			   					   style="display:none; background-color: #ff3e3e;" value="ë³‘ì›ì •ë³´ ìˆ˜ì •"/>
							<input type="button" id="saveBtn" class="btn btn-danger btnCss m-0 border-0"
			   					   style="background-color: #ff3e3e;" value="ë³‘ì›ì •ë³´ ì €ì¥" />
							<!-- ë³‘ì› ì •ë³´ ìˆ˜ì • ë²„íŠ¼ -->
						</div>
					</div>

					
						<div class="card-body" style="height: 897px;">
							<p>ë³‘ì›ê¸°ë³¸ì •ë³´</p>
							<hr>
							<div class="row">
								<div class="col-md-8">
									<div class="row hospitalRow">
										<div class="col-md-4">
											<label for="hiBrno">ë³‘ì›ëª…</label>
										</div>
										<div class="col-md-8">
											<!--ë³‘ì›ëª… ì…ë ¥ì¹¸ -->
											<input type="text" class="form-control form-control-user" id="hiNm"
												   name="hiNm" value="${hosInfo.hiNm}" required readonly>
										</div>
									</div>
									<div class="row hospitalRow">
										<div class="col-md-4">
											<label for="hiType">ë³‘ì› êµ¬ë¶„</label>
										</div>
										<div class="col-md-8">
											<select class="form-control form-control-user" id=hiType name="hiType" disabled>
												<option value="">ì „ì²´</option>
												<c:forEach var="hiType" items="${requestScope.hiTypeList}">
													<option value="${hiType.commCdNm}"
														<c:if test='${hiType.commCdNm == hosInfo.hiType}'>selected</c:if>>${hiType.commCdCnt}</option>
												</c:forEach>
											</select><br />
										</div>
									</div>
									<div class="row hospitalRow">
										<div class="col-md-4">
											<label for="hiBrno">ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸</label>
										</div>
										<div class="col-md-8">
											<!-- ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸ -->
											<input type="text" class="form-control form-control-user" id="hiBrno"
												   name="hiBrno" value="${hosInfo.hiBrno}"
												   pattern="[0-9]{3}-[0-9]{2}-[0-9]{5}" required readonly> 
										</div>
									</div>
								</div>
								<!-- col-md-8 ë -->
								<!-- íŒŒì¼ ì—…ë¡œë“œ ì‹œì‘ -->
								<div class="col-md-4" style="margin-top: 15px;">
									<label>ë³‘ì›ëŒ€í‘œ ë„ì¥</label>
									<table border="1px;">
										<table border="1px;">
											<tr height="200px;">
												<td width="140px;">
													<div class="col-lg-5 d-none d-lg-block bg-register-image">
														<img id="hiImg" src="/resources/images/hospital${hosInfo.hiImg}"
															onerror="this.src='/resources/images/employee/s_cb8450a3-35e9-44e1-9598-730c60f5cb54_user.png'" />
													</div>
												</td>
											</tr>
										</table>
											<!-- ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ì‹œì‘-->
											<div class="imgs_wrap"></div>
											<!-- ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ë-->
											<input type="file" class="d-none" id="input_imgs" name="file" />
									</table><br />
									
									<!--  ì‚¬ì§„ ì„ íƒ -->
									<label for="uploadFile" class="form-label" id="input_imgs"></label>
									<input type="file" id="uploadFile" name="uploadFile" disabled> 
								</div>
								<!-- íŒŒì¼ ì—…ë¡œë“œ ë -->
							</div>

							<p>ë“±ë¡ì •ë³´</p>
							<hr>
							
							<div class="row hospitalRow">
								<div class="col-md-6">
									<!-- ì „í™”ë²ˆí˜¸ -->
									<label for="hiPhone">ì „í™”ë²ˆí˜¸</label> <input type="tel"
										   class="form-control form-control-user" id="hiPhone" name="hiPhone"
										   value="${hosInfo.hiPhone}"
										   pattern="[0-9]{3}-[0-9]{3}-[0-9]{5}" required readonly> 
								</div>
								<div class="col-md-6">
									<!-- íŒ©ìŠ¤ë²ˆí˜¸ -->
									<label for="hiFax">íŒ©ìŠ¤ë²ˆí˜¸</label> <input type="tel"
										   class="form-control form-control-user" id="hiFax" name="hiFax"
										   value="${hosInfo.hiFax}" pattern="[0-9]{3}-[0-9]{3}-[0-9]{5}"
										   required readonly>
								</div>
							</div>
							<div class="row hospitalRow">
								<div class="col-md-6">
									<label for="hiEml">email</label> <input type="email"
										   class="form-control form-control-user" id="hiEml" name="hiEml"
										   value="${hosInfo.hiEml}" pattern=".+@globex\.com" size="30"
										   required readonly>
								</div>
								<div class="col-md-6">
									<label for="hiHp">í™ˆí˜ì´ì§€</label> <input type="url"
										   class="form-control form-control-user" name="hiHp" id="hiHp"
										   value="${hosInfo.hiHp}" placeholder="https://example.com"
										   pattern="https://.*" size="30" required readonly>
								</div>
							</div>
							<div class="row zip">
								<div class="col-md-6">
									<!-- ìš°í¸ë²ˆí˜¸ -->
									<label for="hiZip">ì£¼ì†Œ</label> <input type="text"
										class="form-control form-control-user" id="hiZip" name="hiZip"
										value="${hosInfo.hiZip}" required readonly>
								</div>
								<div class="col-md-6">
									<div class="col-md-6" style="height: 45%;"></div>
									<div class="row">
									<!-- ìš°í¸ë²ˆí˜¸ ê²€ìƒ‰ -->
									<button type="button" class="btn btn-success btn-block"
										style="background-color: #904aff; border: none; height: 50%; float: right; width: 30%;" id="zipSearch"
										onclick="openHomeSearch();" disabled>ì£¼ì†Œê²€ìƒ‰</button>
									</div>
								</div>
							</div>
							<div class="row zip">
								<div class="col-md-12">
									<input type="text" class="form-control form-control-user" id="hiAddr"
										name="hiAddr" placeholder="ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"
										value="${hosInfo.hiAddr}" required readonly>
								</div>
							</div>
							<div class="row zip">
								<div class="col-md-12">
									<input type="text" class="form-control form-control-user" id="hiDaddr"
										name="hiDaddr" placeholder="ìƒì„¸ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"
										value="${hosInfo.hiDaddr}" required readonly>
								</div>
							</div>
						</div>
				</div>
					<!-- Cross Site Request Forgery -->
					<sec:csrfInput />		
				</form>
			</div>

			<!-- ìš°ì¸¡ -->
			<div class="col-md-6">

				<div class="card card-info">

					<div class="card-header"
						 style="background-color: #404b57; border: none;">
						<div class="d-flex justify-content-between align-items-center">
							<h2 class="card-title">ëŒ€í‘œì ì •ë³´</h2>
						</div>
					</div>

					<div class="card-body">
						<div class="row hospitalRow">
							<div class="col-md-6">
								<!-- ëŒ€í‘œìëª… -->
								<label for="hiRprsvNm">ëŒ€í‘œìëª…</label> <input type="text"
									class="form-control form-control-user" id="hiRprsvNm" name="hiRprsvNm"
									value="${hosInfo.hiRprsvNm}" required readonly>
							</div>
							<div class="col-md-6">
								<!-- ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ -->							
								<label for="hiRprsvRrno">ëŒ€í‘œì ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</label> 
								<input type="password"
									class="form-control form-control-user" id="hiRprsvRrno" name="hiRprsvRrno"
									placeholder="ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”." title="'-'ë¥¼ ë¶™ì—¬ í˜•ì‹ì— ë§ê²Œì…ë ¥í•´ì£¼ì„¸ìš”."
									value="${hosInfo.hiRprsvRrno}" required readonly>
							</div>
						</div>



					</div>
				</div>
				<!-- ìš°ì¸¡ ì¤‘ì•™ -->
				<div class="card card-info">

					<div class="card-header"
						style="background-color: #404b57; border: none;">
						<div class="d-flex justify-content-between align-items-center">
							<h2 class="card-title">ë³‘ì› ìš´ì˜ì •ë³´</h2>
						</div>
					</div>

					<div class="card-body">
						<div class="row hospitalRow">
							<div class="col-md-4">
								<label>Office hours</label>
							</div>
							<div class="col-sm-4">
								<input type="time" class="form-control form-control-user" id="hiOpenTime"
									name="hiOpenTime" min="09:00:00" max="18:00:00"
									value="${hosInfo.hiOpenTime}" required readonly>
							</div>
							<div class="col-sm-4">
								<input type="time" class="form-control form-control-user" id="hiCloseTime"
									name="hiCloseTime" min="09:00" max="18:00"
									value="${hosInfo.hiCloseTime}" required readonly>
							</div>
						</div>
						<div class="row hospitalRow">
							<div class="col-md-4">
								<label>ë³‘ì› íœ´ì‹ì‹œê°„</label>
							</div>
							<div class="col-sm-4">
								<input type="time" class="form-control form-control-user" id="hiLunchStime"
									name="hiLunchStime" min="09:00" max="18:00"
									value="${hosInfo.hiLunchStime}" required readonly>
							</div>
							<div class="col-sm-4">
								<input type="time" class="form-control form-control-user" id="hiLunchEtime"
									name="hiLunchEtime" min="09:00" max="18:00"
									value="${hosInfo.hiLunchEtime}" required readonly>
							</div>
						</div>
					</div>
				</div>
				</form>
								<!-- ìš°ì¸¡ í•˜ë‹¨ -->
				<div class="card card-info">

					<div class="card-header"
						style="background-color: #404b57; border: none;">
						<div class="d-flex justify-content-between align-items-center">
							<h4 class="card-title">ì²´ì–´ ê´€ë¦¬</h4>
						</div>
					</div>
					<!-- 					https://inpa.tistory.com/1093#datalist_%ED%83%9C%EA%B7%B8 -->
					<div class="card-body" style="height: 450px;">
					
						<form name="myTable" action="" method="post">
							<div class="card-body"
								style="max-height: 317px; overflow-y: auto;">
								<table class="table table-bordered chairTable" id="myTable">
									<thead>
										<tr>
											<th style="width: 10px">ğŸ› </th>
											<th>No.</th>
											<!-- ìë™ìƒì„± -->
											<th>ì²´ì–´ëª…</th>
											<!-- ì§ì ‘ ì…ë ¥ -->
											<th>ë¶€ì„œ</th>
											<!-- ì§ì ‘ ì…ë ¥ -->
										</tr>
									</thead>
									<tbody id="chairListBody">
										<c:forEach var="chair" items="${requestScope.chairList}"
											varStatus="stat">
											<tr class="trClassDelete">
												<td>
													<input type="checkbox" class="form-control chairSelected" id="deleteChairCheck"
														   name="user_CheckBox" id="" required /></td>
												<td>${chair.chairSn}</td>
												<td>
													<input type="text"
													data-chair="${chair.chairNm}" class="form-control updateInput"
													value="${chair.chairNm}" style="border: none;" readonly /></td>
												<td>
													<select id="deptCd" name="deptCd" class="form-control"
													data-dept="${chair.deptCd}" disabled>
														<option value="">ì§„ë£Œì‹¤ ì„ íƒ</option>
														<c:forEach var="dept" items="${requestScope.deptList}">
															<option value="${dept.deptCd}"
																<c:if test='${dept.deptCd == chair.deptCd}'>selected</c:if>>${dept.deptNm}</option>
														</c:forEach>
												</select></td>
											</tr>
										</c:forEach>
									</tbody>
								</table>

								

								<!-- í…Œì´ë¸”ì— ì¶”ê°€í•  í…Œì´ë¸” ë‚´ë¶€ í…œí”Œë¦¿ -->
								<template id="rowTemplate">
									<tr class="trClassAdd">
										<td id="td1"><input type="checkbox" class="form-control"  name="user_Check" id="checkYn" required checked></td>
										<td id="td2"></td>
										<td id="td3"><input type="text" class="form-control" id="chairNm"/></td>
										<td id="td4"><select id="deptCd" name="deptCd" class="form-control updateInput" >
												<option value="">ì§„ë£Œì‹¤ ì„ íƒ</option>
												<c:forEach var="dept" items="${requestScope.deptList}">
													<option value="${dept.deptCd}"
														<c:if test='${deptCd == dept.deptCd}'>selected</c:if>>${dept.deptNm}</option>
												</c:forEach>
										</select></td>
									</tr>
								</template>
								
								<template id="readOnlyTemplate">
									<tr class="trClassAdd">
										<td id="td1"><input type="checkbox"  name="user_Check" id="checkYn"></td>
										<td id="td2"></td>
										<td id="td3"><input type="text"  id="chairNm" style="border:none;" readOnly/></td>
										<td id="td4"><select id="deptCd" name="deptCd" class="updateInput" disabled >
												<option value="">ì§„ë£Œì‹¤ ì„ íƒ</option>
												<c:forEach var="dept" items="${requestScope.deptList}">
													<option value="${dept.deptCd}">${dept.deptNm}</option>
												</c:forEach>
										</select></td>
									</tr>
								</template>

							</div>
						</form>
						<div class="card-footer">
						<!-- ì¼ë°˜ëª¨ë“œ ì‹œì‘ -->
							
						<!-- ë²„íŠ¼ í´ë¦­í•˜ë©´ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ -->
						<input type="button" class="btn btn-success btn-inline btnCss" id="addTr" value="ì¶”ê°€" onclick="addRow()" disabled
						   style="background-color: #904aff; border: none; width: 10%; float:left; margin-right:-0.2em;" />
						<span id="spn1">
							<!-- ì €ì¥ í´ë¦­í•˜ë©´ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ -->
							<input type="button" class="btn btn-success btn-inline btnCss" id="updateChair" value="ì €ì¥" onclick="updateRow()" disabled
								   style="background-color: #904aff; border: none; width: 10%; margin-left:10px;"/> 
						    <input type="button" class="btn btn-success btn-inline btnCss" id="deleteChair" value="ì‚­ì œ" onclick="deleteRow()" disabled
						    	   style="background-color: #904aff; border: none; width: 10%;"/>
				        </span>
						<!-- ì¼ë°˜ëª¨ë“œ ë -->

						<!-- ìˆ˜ì •ëª¨ë“œ ì‹œì‘ -->
						<span id="spn2" style="display: none;"> 
							<input type="button" class="btn btn-success btn-inline btnCss" id="createChair" value="ì¶”ê°€í•­ëª© ì €ì¥" onclick="createRow()"
							       style="background-color: #904aff; border: none; width: 22%; margin-left:8px;">
							<input type="button" class="btn btn-success btn-inline btnCss" id="cancelBtn"  value="ì·¨ì†Œ"
							       style="background-color: #904aff; border: none; width: 10%;" />
						</span>
						<!-- ìˆ˜ì •ëª¨ë“œ ë -->
		
						
						</div>
					</div>
				</div>
			</div>
			
		</div>
	</section>
</div>